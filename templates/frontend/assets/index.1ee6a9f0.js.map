{"version":3,"file":"index.1ee6a9f0.js","sources":["../../../../ui/packages/icons/src/TextHighlight.svelte","../../../../ui/packages/highlighted-text/src/HighlightedText.svelte","../../../../ui/packages/app/src/components/HighlightedText/HighlightedText.svelte","../../../../ui/packages/app/src/components/HighlightedText/index.ts"],"sourcesContent":["<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\txmlns:xlink=\"http://www.w3.org/1999/xlink\"\r\n\taria-hidden=\"true\"\r\n\trole=\"img\"\r\n\tclass=\"iconify iconify--carbon\"\r\n\twidth=\"100%\"\r\n\theight=\"100%\"\r\n\tpreserveAspectRatio=\"xMidYMid meet\"\r\n\tviewBox=\"0 0 32 32\"\r\n\t><path\r\n\t\tfill=\"currentColor\"\r\n\t\td=\"M12 15H5a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5V5a1 1 0 0 0-1-1H3V2h6a3 3 0 0 1 3 3zM5 9a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h5V9zm15 14v2a1 1 0 0 0 1 1h5v-4h-5a1 1 0 0 0-1 1z\"\r\n\t/><path\r\n\t\tfill=\"currentColor\"\r\n\t\td=\"M2 30h28V2Zm26-2h-7a3 3 0 0 1-3-3v-2a3 3 0 0 1 3-3h5v-2a1 1 0 0 0-1-1h-6v-2h6a3 3 0 0 1 3 3Z\"\r\n\t/></svg\r\n>\r\n","<script lang=\"ts\">\r\n\tconst browser = typeof document !== \"undefined\";\r\n\timport { colors } from \"@gradio/theme\";\r\n\timport { get_next_color } from \"@gradio/utils\";\r\n\r\n\texport let value: Array<[string, string | number]> = [];\r\n\texport let show_legend: boolean = false;\r\n\texport let color_map: Record<string, string> = {};\r\n\r\n\tlet ctx: CanvasRenderingContext2D;\r\n\r\n\tlet _color_map: Record<string, { primary: string; secondary: string }> = {};\r\n\tlet active = \"\";\r\n\r\n\tfunction name_to_rgba(name: string, a: number) {\r\n\t\tif (!ctx) {\r\n\t\t\tvar canvas = document.createElement(\"canvas\");\r\n\t\t\tctx = canvas.getContext(\"2d\")!;\r\n\t\t}\r\n\t\tctx.fillStyle = name;\r\n\t\tctx.fillRect(0, 0, 1, 1);\r\n\t\tconst [r, g, b] = ctx.getImageData(0, 0, 1, 1).data;\r\n\t\tctx.clearRect(0, 0, 1, 1);\r\n\t\treturn `rgba(${r}, ${g}, ${b}, ${255 / a})`;\r\n\t}\r\n\r\n\tlet mode: \"categories\" | \"scores\";\r\n\r\n\t$: {\r\n\t\tif (!color_map) {\r\n\t\t\tcolor_map = {};\r\n\t\t}\r\n\t\tif (value.length > 0) {\r\n\t\t\tfor (let [_, label] of value) {\r\n\t\t\t\tif (label !== null) {\r\n\t\t\t\t\tif (typeof label === \"string\") {\r\n\t\t\t\t\t\tmode = \"categories\";\r\n\t\t\t\t\t\tif (!(label in color_map)) {\r\n\t\t\t\t\t\t\tlet color = get_next_color(Object.keys(color_map).length);\r\n\t\t\t\t\t\t\tcolor_map[label] = color;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmode = \"scores\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction correct_color_map() {\r\n\t\t\tfor (const col in color_map) {\r\n\t\t\t\tconst _c = color_map[col].trim();\r\n\t\t\t\tif (_c in colors) {\r\n\t\t\t\t\t_color_map[col] = colors[_c as keyof typeof colors];\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_color_map[col] = {\r\n\t\t\t\t\t\tprimary: browser ? name_to_rgba(color_map[col], 1) : color_map[col],\r\n\t\t\t\t\t\tsecondary: browser\r\n\t\t\t\t\t\t\t? name_to_rgba(color_map[col], 0.5)\r\n\t\t\t\t\t\t\t: color_map[col]\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcorrect_color_map();\r\n\t}\r\n\r\n\tfunction handle_mouseover(label: string) {\r\n\t\tactive = label;\r\n\t}\r\n\tfunction handle_mouseout() {\r\n\t\tactive = \"\";\r\n\t}\r\n</script>\r\n\r\n<!-- \r\n\t@todo victor: try reimplementing without flex (negative margins on container to avoid left margin on linebreak). \r\n\tIf not possible hijack the copy execution like this:\r\n\r\n<svelte:window\r\n\ton:copy|preventDefault={() => {\r\n\t\tconst selection =.getSelection()?.toString();\r\n\t\tconsole.log(selection?.replaceAll(\"\\n\", \" \"));\r\n\t}}\r\n/>\r\n-->\r\n\r\n{#if mode === \"categories\"}\r\n\t{#if show_legend}\r\n\t\t<div\r\n\t\t\tclass=\"category-legend flex flex-wrap gap-1 mb-2 text-black mt-7\"\r\n\t\t\tdata-testid=\"highlighted-text:category-legend\"\r\n\t\t>\r\n\t\t\t{#each Object.entries(_color_map) as [category, color], i}\r\n\t\t\t\t<div\r\n\t\t\t\t\ton:mouseover={() => handle_mouseover(category)}\r\n\t\t\t\t\ton:focus={() => handle_mouseover(category)}\r\n\t\t\t\t\ton:mouseout={() => handle_mouseout()}\r\n\t\t\t\t\ton:blur={() => handle_mouseout()}\r\n\t\t\t\t\tclass=\"category-label px-2 rounded-sm font-semibold cursor-pointer\"\r\n\t\t\t\t\tstyle={\"background-color:\" + color.secondary}\r\n\t\t\t\t>\r\n\t\t\t\t\t{category}\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t{/if}\r\n\t<div\r\n\t\tclass=\"textfield bg-white dark:bg-transparent rounded-sm text-sm box-border max-w-full break-word leading-7 mt-7\"\r\n\t\tdata-testid=\"highlighted-text:textfield\"\r\n\t>\r\n\t\t{#each value as [text, category]}\r\n\t\t\t<span\r\n\t\t\t\tclass=\"textspan rounded-sm px-1 transition-colors text-black  pb-[0.225rem] pt-[0.15rem]\"\r\n\t\t\t\tstyle:background-color={category === null ||\r\n\t\t\t\t(active && active !== category)\r\n\t\t\t\t\t? \"\"\r\n\t\t\t\t\t: _color_map[category].secondary}\r\n\t\t\t\tclass:dark:text-white={category === null ||\r\n\t\t\t\t\t(active && active !== category)}\r\n\t\t\t\tclass:hl={category !== null}\r\n\t\t\t>\r\n\t\t\t\t<span class=\"text \">{text}</span>\r\n\t\t\t\t{#if !show_legend && category !== null}\r\n\t\t\t\t\t&nbsp;<span\r\n\t\t\t\t\t\tclass=\"label mr-[-4px] font-bold uppercase text-xs inline-category  text-white rounded-sm  px-[0.325rem] mt-[0.05rem] py-[0.05rem] transition-colors\"\r\n\t\t\t\t\t\tstyle:background-color={category === null ||\r\n\t\t\t\t\t\t(active && active !== category)\r\n\t\t\t\t\t\t\t? \"\"\r\n\t\t\t\t\t\t\t: _color_map[category].primary}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{category}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t{/if}</span\r\n\t\t\t>\r\n\t\t{/each}\r\n\t</div>\r\n{:else}\r\n\t{#if show_legend}\r\n\t\t<div\r\n\t\t\tclass=\"color_legend flex px-2 py-1 justify-between rounded mb-3 font-semibold mt-7\"\r\n\t\t\tdata-testid=\"highlighted-text:color-legend\"\r\n\t\t\tstyle=\"background: -webkit-linear-gradient(to right,#8d83d6,(255,255,255,0),#eb4d4b); background: linear-gradient(to right,#8d83d6,rgba(255,255,255,0),#eb4d4b);\"\r\n\t\t>\r\n\t\t\t<span>-1</span>\r\n\t\t\t<span>0</span>\r\n\t\t\t<span>+1</span>\r\n\t\t</div>\r\n\t{/if}\r\n\t<div\r\n\t\tclass=\"textfield p-2 bg-white dark:bg-gray-800 rounded box-border max-w-full break-word leading-7\"\r\n\t\tdata-testid=\"highlighted-text:textfield\"\r\n\t>\r\n\t\t{#each value as [text, score]}\r\n\t\t\t<span\r\n\t\t\t\tclass=\"textspan p-1 mr-0.5 bg-opacity-20 dark:bg-opacity-80 rounded-sm\"\r\n\t\t\t\tstyle={\"background-color: rgba(\" +\r\n\t\t\t\t\t(score < 0 ? \"141, 131, 214,\" + -score : \"235, 77, 75,\" + score) +\r\n\t\t\t\t\t\")\"}\r\n\t\t\t>\r\n\t\t\t\t<span class=\"text dark:text-white\">{text}</span>\r\n\t\t\t</span>\r\n\t\t{/each}\r\n\t</div>\r\n{/if}\r\n\r\n<style>\r\n\t.hl + .hl {\r\n\t\t@apply ml-1;\r\n\t}\r\n\r\n\t.textspan:last-child > .label {\r\n\t\t@apply mr-0;\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\timport { createEventDispatcher } from \"svelte\";\r\n\timport { HighlightedText } from \"@gradio/highlighted-text\";\r\n\timport { Block, BlockLabel } from \"@gradio/atoms\";\r\n\timport { TextHighlight } from \"@gradio/icons\";\r\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\r\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\r\n\timport type { Styles } from \"@gradio/utils\";\r\n\r\n\texport let elem_id: string = \"\";\r\n\texport let visible: boolean = true;\r\n\texport let value: Array<[string, string | number]>;\r\n\texport let show_legend: boolean;\r\n\texport let color_map: Record<string, string> = {};\r\n\texport let label: string;\r\n\texport let style: Styles = {};\r\n\r\n\t$: if (!style.color_map && Object.keys(color_map).length) {\r\n\t\tstyle.color_map = color_map;\r\n\t}\r\n\r\n\texport let loading_status: LoadingStatus;\r\n\r\n\tconst dispatch = createEventDispatcher<{ change: undefined }>();\r\n\r\n\t$: value, dispatch(\"change\");\r\n</script>\r\n\r\n<Block\r\n\ttest_id=\"highlighted-text\"\r\n\t{visible}\r\n\t{elem_id}\r\n\tdisable={typeof style.container === \"boolean\" && !style.container}\r\n>\r\n\t<StatusTracker {...loading_status} />\r\n\t{#if label}\r\n\t\t<BlockLabel\r\n\t\t\tIcon={TextHighlight}\r\n\t\t\t{label}\r\n\t\t\tdisable={typeof style.container === \"boolean\" && !style.container}\r\n\t\t/>\r\n\t{/if}\r\n\r\n\t{#if value}\r\n\t\t<HighlightedText {value} {show_legend} color_map={style.color_map} />\r\n\t{:else}\r\n\t\t<div class=\"h-full min-h-[6rem] flex justify-center items-center\">\r\n\t\t\t<div class=\"h-5 dark:text-white opacity-50\"><TextHighlight /></div>\r\n\t\t</div>\r\n\t{/if}\r\n</Block>\r\n","export { default as Component } from \"./HighlightedText.svelte\";\r\nexport const modes = [\"static\"];\r\n\r\nexport const document = (config: Record<string, any>) => ({\r\n\ttype: \"Array<[string, string | number]>\",\r\n\tdescription: \"list of text spans and corresponding label / value\"\r\n});\r\n"],"names":["document"],"mappings":"iiCAAA,SAUE,OAGC,iWC4HG,YAeG,0BAAL,8RAJH,+DAXK,oEAeG,uBAAL,6HAAA,0EAjEE,aAuBG,0BAAL,8SAJH,+DAnBK,8EAuBG,uBAAL,8HAAA;;kVA4BF,iDAqBsC,gMAJ7B,0BACL,OAAQ,EAAI,kBAAoB,MAAQ,eAAiB,OAC1D,GAAG,UAJL,SAMC,yCAAoC,8BAJ7B,0BACL,OAAQ,EAAI,kBAAoB,MAAQ,eAAiB,OAC1D,2DAjEK,OAAO,QAAQ,2BAApB,+NAJH,wEAIQ,OAAO,QAAQ,wBAApB,6HAAA,qDASC,+MAFM,oBAAsB,MAAM,SAAS,UAN7C,uIAQE,8BAFM,oBAAsB,MAAM,+EA+BjC,4BARoC,MAChC,2NAEmB,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,6BALnB,6CAOJ,+CALuB,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,qEAPL,gBACf,MAAe,QAAa,8NALX,QAAa,MAClC,MAAU,OAAW,gBACb,QAAa,IAAI,yBANH,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,sBALzB,SAUC,wDAAqB,mBACf,MAAe,QAAa,0FALX,QAAa,MAClC,MAAU,OAAW,qBACb,QAAa,IAAI,+BANH,QAAa,MACpC,MAAU,OAAW,MACnB,GACA,KAAW,OAAU,kFA9BvB,QAAS,gOArFP,SAAiB,UAAa,QAIzB,eACA,cAAuB,OACvB,kBAEP,EAEA,KACA,EAAS,cAES,EAAc,OAC9B,MACA,GAAS,SAAS,cAAc,QAAQ,EAC5C,EAAM,EAAO,WAAW,IAAI,EAE7B,EAAI,UAAY,EAChB,EAAI,SAAS,EAAG,EAAG,EAAG,CAAC,QAChB,EAAG,GAAG,IAAK,EAAI,aAAa,EAAG,EAAG,EAAG,CAAC,EAAE,KAC/C,SAAI,UAAU,EAAG,EAAG,EAAG,CAAC,UACT,MAAM,OAAM,OAAM,IAAM,QAGpC,cAwCsB,OACzB,EAAS,CAAK,mBAGd,EAAS,EAAE,aAwBY,EAAiB,CAAQ,OAC7B,EAAiB,CAAQ,QACtB,UACJ,uKAlDT,uBACG,KAAO,SACX,GAAK,EAAU,GAAK,OACtB,IAAM,OACT,EAAW,GAAO,EAAO,UAEzB,EAAW,IACV,QAAS,EAAU,EAAa,EAAU,GAAM,CAAC,EAAI,EAAU,GAC/D,UAAW,EACR,EAAa,EAAU,GAAM,EAAG,EAChC,EAAU,YA5BZ,OACJ,MAEG,EAAM,OAAS,WACR,EAAG,IAAU,MAClB,IAAU,cACF,IAAU,iBACpB,EAAO,YAAY,GACb,KAAS,QACV,GAAQ,GAAe,OAAO,KAAK,CAAS,EAAE,MAAM,MACxD,EAAU,GAAS,eAGpB,EAAO,QAAQ,EAqBnB,qLC1BO,4BAEU,MAAM,WAAc,YAAc,KAAM,uHAAxC,MAAM,WAAc,YAAc,KAAM,0TAOzD,SACC,uMAHiD,KAAM,6IAAN,KAAM,+IAVtC,kFACd,uDAQA,sMATc,qBACd,0fAHW,MAAM,WAAc,YAAc,KAAM,uLAAxC,MAAM,WAAc,YAAc,KAAM,+JAvB7C,UAAkB,OAClB,UAAmB,OACnB,YACA,kBACA,mBACA,YACA,eAMA,yBAEL,GAAW,yUANT,EAAM,WAAa,OAAO,KAAK,CAAS,EAAE,YACjD,EAAM,UAAY,mBAOT,EAAS,QAAQ,0LCxBf,IAAQ,CAAC,QAAQ,EAEjBA,GAAW,AAAC,KACxB,KAAM,mCACN,YAAa,oDACd"}