{"version":3,"file":"index.e184de4f.js","sources":["../../../../ui/packages/video-with-caption/src/PlayerWithCaption.svelte","../../../../ui/packages/video-with-caption/src/VideoWithCaption.svelte","../../../../ui/packages/app/src/components/VideoWithCaption/VideoWithCaption.svelte","../../../../ui/packages/app/src/components/VideoWithCaption/index.ts"],"sourcesContent":["<script lang=\"ts\">\n\timport { tick } from \"svelte\";\n\timport { Play, Pause, Maximise, Undo } from \"@gradio/icons\";\n\n\texport let src: string;\n\texport let caption: string;\n\texport let mirror: boolean;\n\n\tlet time: number = 0;\n\tlet duration: number;\n\tlet paused: boolean = true;\n\tlet video: HTMLVideoElement;\n\n\tlet show_controls = true;\n\tlet show_controls_timeout: NodeJS.Timeout;\n\n\tfunction video_move() {\n\t\tclearTimeout(show_controls_timeout);\n\t\tshow_controls_timeout = setTimeout(() => (show_controls = false), 2500);\n\t\tshow_controls = true;\n\t}\n\n\tfunction handleMove(e: TouchEvent | MouseEvent) {\n\t\tif (!duration) return;\n\n\t\tif (e.type === \"click\") {\n\t\t\thandle_click(e as MouseEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.type !== \"touchmove\" && !((e as MouseEvent).buttons & 1)) return;\n\n\t\tconst clientX =\n\t\t\te.type === \"touchmove\"\n\t\t\t\t? (e as TouchEvent).touches[0].clientX\n\t\t\t\t: (e as MouseEvent).clientX;\n\t\tconst { left, right } = (\n\t\t\te.currentTarget as HTMLProgressElement\n\t\t).getBoundingClientRect();\n\t\ttime = (duration * (clientX - left)) / (right - left);\n\t}\n\n\tfunction play_pause() {\n\t\tif (paused) video.play();\n\t\telse video.pause();\n\t}\n\n\tfunction handle_click(e: MouseEvent) {\n\t\tconst { left, right } = (\n\t\t\te.currentTarget as HTMLProgressElement\n\t\t).getBoundingClientRect();\n\t\ttime = (duration * (e.clientX - left)) / (right - left);\n\t}\n\n\tfunction format(seconds: number) {\n\t\tif (isNaN(seconds) || !isFinite(seconds)) return \"...\";\n\n\t\tconst minutes = Math.floor(seconds / 60);\n\t\tlet _seconds: number | string = Math.floor(seconds % 60);\n\t\tif (seconds < 10) _seconds = `0${_seconds}`;\n\n\t\treturn `${minutes}:${_seconds}`;\n\t}\n\n\tasync function _load() {\n\t\tawait tick();\n\t\tvideo.currentTime = 9999;\n\n\t\tsetTimeout(async () => {\n\t\t\tvideo.currentTime = 0.0;\n\t\t}, 50);\n\t}\n\n\t$: src && _load();\n</script>\n\n<div>\n\t<video\n\t\t{src}\n\t\tpreload=\"auto\"\n\t\tcrossorigin=\"anonymous\"\n\t\ton:mousemove={video_move}\n\t\ton:click={play_pause}\n\t\ton:play\n\t\ton:pause\n\t\ton:ended\n\t\tbind:currentTime={time}\n\t\tbind:duration\n\t\tbind:paused\n\t\tbind:this={video}\n\t\tclass=\"w-full h-full object-contain bg-black\"\n\t\tclass:mirror\n\t>\n\t\t<track kind=\"captions\" src={caption} label=\"Subtitles\" default />\n\t</video>\n\n\t<div\n\t\tclass=\"wrap absolute bottom-0 transition duration-500  m-1.5 bg-slate-800 px-1 py-2.5 rounded-md\"\n\t\tstyle=\"opacity: {duration && show_controls ? 1 : 0}\"\n\t\ton:mousemove={video_move}\n\t>\n\t\t<div class=\"flex w-full justify-space h-full items-center px-1.5 \">\n\t\t\t<span\n\t\t\t\tclass=\" w-6 cursor-pointer text-white flex justify-center\"\n\t\t\t\ton:click={play_pause}\n\t\t\t>\n\t\t\t\t{#if time === duration}\n\t\t\t\t\t<Undo />\n\t\t\t\t{:else if paused}\n\t\t\t\t\t<Play />\n\t\t\t\t{:else}\n\t\t\t\t\t<Pause />\n\t\t\t\t{/if}\n\t\t\t</span>\n\n\t\t\t<span class=\"font-mono shrink-0 text-xs mx-3 text-white\"\n\t\t\t\t>{format(time)} / {format(duration)}</span\n\t\t\t>\n\t\t\t<progress\n\t\t\t\tvalue={time / duration || 0}\n\t\t\t\ton:mousemove={handleMove}\n\t\t\t\ton:touchmove|preventDefault={handleMove}\n\t\t\t\ton:click|stopPropagation|preventDefault={handle_click}\n\t\t\t\tclass=\"rounded h-2 w-full mx-3\"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tclass=\"w-6 cursor-pointer text-white\"\n\t\t\t\ton:click={() => video.requestFullscreen()}\n\t\t\t>\n\t\t\t\t<Maximise />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<style lang=\"postcss\">\n\tspan {\n\t\ttext-shadow: 0 0 8px rgba(0, 0, 0, 0.5);\n\t}\n\n\tprogress::-webkit-progress-bar {\n\t\tborder-radius: 2px;\n\t\tbackground-color: rgba(255, 255, 255, 0.2);\n\t\toverflow: hidden;\n\t}\n\n\tprogress::-webkit-progress-value {\n\t\t/* border-radius: 2px; */\n\n\t\tbackground-color: rgba(255, 255, 255, 0.9);\n\t}\n\n\t.mirror {\n\t\ttransform: scaleX(-1);\n\t}\n\n\t.wrap {\n\t\twidth: calc(100% - 0.375rem * 2);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { createEventDispatcher } from \"svelte\";\n\timport { BlockLabel } from \"@gradio/atoms\";\n\timport type { FileData } from \"@gradio/upload\";\n\timport { Video } from \"@gradio/icons\";\n\n\timport PlayerWithCaption from \"./PlayerWithCaption.svelte\";\n\n\texport let value: FileData | null = null;\n\texport let caption: FileData | null = null;\n\texport let label: string | undefined = undefined;\n\texport let show_label: boolean;\n\n\tconst dispatch = createEventDispatcher<{\n\t\tchange: FileData;\n\t\tplay: undefined;\n\t\tpause: undefined;\n\t\tended: undefined;\n\t}>();\n\n\t$: value && dispatch(\"change\", value);\n</script>\n\n<BlockLabel {show_label} Icon={Video} label={label || \"VideoWithCaption\"} />\n{#if value === null || caption === null}\n\t<div class=\"h-full min-h-[15rem] flex justify-center items-center\">\n\t\t<div class=\"h-5 dark:text-white opacity-50\"><Video /></div>\n\t</div>\n{:else}\n\t<!-- svelte-ignore a11y-media-has-caption -->\n\t<PlayerWithCaption\n\t\tsrc={value.data}\n\t\tcaption={caption.data}\n\t\ton:play\n\t\ton:pause\n\t\ton:ended\n\t\tmirror={false}\n\t/>\n{/if}\n","<script lang=\"ts\">\n\timport type { FileData } from \"@gradio/upload\";\n\timport { normalise_file } from \"@gradio/upload\";\n\timport { Block } from \"@gradio/atoms\";\n\timport { VideoWithCaption } from \"@gradio/videowithcaption\";\n\t// import { Video, StaticVideo } from \"@gradio/video\";\n\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\n\timport type { Styles } from \"@gradio/utils\";\n\timport { _ } from \"svelte-i18n\";\n\n\texport let elem_id: string = \"\";\n\texport let visible: boolean = true;\n\texport let value: Array<FileData>;\n\texport let label: string;\n\texport let source: string;\n\texport let root: string;\n\texport let root_url: null | string;\n\texport let show_label: boolean;\n\texport let loading_status: LoadingStatus;\n\texport let style: Styles = {};\n\t// export let mirror_webcam: boolean;\n\n\texport let mode: \"static\" | \"dynamic\";\n\n\tlet _src: null | FileData;\n\t$: _src = normalise_file(value[0], root_url ?? root);\n\n\tlet _caption: null | FileData;\n\t$: _caption = normalise_file(value[1], root_url ?? root);\n\n\tconsole.log(_src, _caption);\n\tlet dragging = false;\n</script>\n\n<Block\n\t{visible}\n\tvariant={mode === \"dynamic\" && value === null && source === \"upload\"\n\t\t? \"dashed\"\n\t\t: \"solid\"}\n\tcolor={dragging ? \"green\" : \"grey\"}\n\tpadding={false}\n\t{elem_id}\n\tstyle={{ height: style.height, width: style.width }}\n>\n\t<StatusTracker {...loading_status} />\n\n\t<VideoWithCaption value={_src} caption={_caption} {label} {show_label} />\n</Block>\n\n<!-- <div /> -->\n","export { default as Component } from \"./VideoWithCaption.svelte\";\nexport const modes = [\"static\", \"dynamic\"];\n\nexport const document = (config: Record<string, any>) => ({\n\ttype: \"{ name: string; data: string }\",\n\tdescription: \"file name and base64 data of video file with caption\"\n});\n"],"names":[],"mappings":"8kCAoHM,EAAO,eAAU,EAAO,2JAVrB,QAAS,OAEJ,0KAQK,KAAG,kGAvBQ,6aA0BnB,KAAO,MAAY,gTArBX,MAAY,KAAgB,EAAI,CAAC,UAtBpD,SACC,OAgBC,uBAGD,OAKC,OACC,6BAaA,mCAGA,cAQA,+CA7Ca,kBACJ,iKAsBE,uBAgBI,yBACe,yBACY,4CAvB7B,4CANc,4EAPV,sBAAA,oNA8Bd,EAAO,sCAAU,EAAO,qCAGnB,KAAO,MAAY,6CArBX,MAAY,KAAgB,EAAI,CAAC,6IA5CnC,MACX,MAAM,CAAO,IAAM,SAAS,CAAO,QAAU,WAE3C,GAAU,KAAK,MAAM,EAAU,EAAE,KACnC,GAA4B,KAAK,MAAM,EAAU,EAAE,QACnD,GAAU,IAAI,OAAe,QAEvB,KAAW,2BAzDX,UACA,cACA,YAEP,EAAe,EACf,EACA,EAAkB,GAClB,EAEA,EAAgB,GAChB,eAGH,aAAa,CAAqB,EAClC,EAAwB,mBAAkB,EAAgB,EAAK,EAAG,IAAI,MACtE,EAAgB,EAAI,aAGD,OACd,YAED,EAAE,OAAS,SACd,EAAa,CAAe,YAIzB,EAAE,OAAS,cAAkB,GAAiB,QAAU,eAEtD,GACL,EAAE,OAAS,YACP,EAAiB,QAAQ,GAAG,QAC5B,EAAiB,SACd,OAAM,SACb,EAAE,cACD,4BACF,EAAQ,EAAY,GAAU,GAAU,GAAQ,iBAI5C,EAAQ,EAAM,OACb,EAAM,mBAGU,SACb,OAAM,SACb,EAAE,cACD,4BACF,EAAQ,EAAY,GAAE,QAAU,GAAU,GAAQ,4BAc5C,UACN,EAAM,YAAc,QAEpB,yBACC,EAAM,YAAc,MAClB,8GAgBe,0IAGP,yBAuCO,EAAM,6JAvDtB,GAAO,0LC1CJ,KAAM,aACF,KAAQ,YAIT,4IALH,KAAM,sBACF,KAAQ,sTAPlB,SACC,wLAH6B,SAAc,MAAS,iEACjD,QAAU,MAAQ,OAAY,+LADU,MAAS,sTAf1C,QAAyB,SACzB,UAA2B,SAC3B,QAA4B,WAC5B,qBAEL,GAAW,mRAOd,GAAS,EAAS,SAAU,CAAK,6JC0BjB,0GAEM,aAAe,uJAFrB,gDAEM,yBAAe,wQAV/B,OAAS,WAAa,OAAU,MAAQ,OAAW,SACzD,SACA,cACyB,eACnB,uBAEA,OAAQ,KAAM,OAAQ,MAAO,KAAM,0JANnC,OAAS,WAAa,OAAU,MAAQ,OAAW,SACzD,SACA,gDAIM,OAAQ,KAAM,OAAQ,MAAO,KAAM,6JAhCjC,UAAkB,OAClB,UAAmB,OACnB,YACA,YACA,aACA,WACA,eACA,iBACA,qBACA,eAGA,UAEP,EAGA,EAGJ,eAAQ,IAAI,EAAM,CAAQ,mZALvB,EAAO,GAAe,EAAM,GAAI,GAAY,CAAI,yBAGhD,EAAW,GAAe,EAAM,GAAI,GAAY,CAAI,4NC7B3C,IAAQ,CAAC,SAAU,SAAS,EAE5B,GAAW,AAAC,KACxB,KAAM,iCACN,YAAa,sDACd"}