import{S as ne,i as le,s as $,B as K,C as d,g as y,E as P,F as J,q as C,af as Ct,G as H,L as V,r as ge,b as L,H as F,ab as Ve,ai as kt,p,l as x,t as A,o as ee,N as vt,u as pt,T as de,a5 as Mt,ac as Ke,ad as $e,D as Tt,M as R,J as N,ak as Bt,a0 as wt,y as ae,e as B,m as z,n as S,ae as Ue,al as zt,f as _e,a as G,k as Q,V as St,X as Et,Y as Rt,Z as Dt,x as Lt,$ as Ut,h as jt,j as qt}from"./index-1bfae066.js";import{B as Ft}from"./Button-f85c92e7.js";import{B as At}from"./BlockLabel-f7c11e39.js";/* empty css                                                    */import{I as je}from"./Image-cbf861f4.js";import{C as Nt,i as Ht,U as Wt,W as Xt}from"./StaticImage.svelte_svelte_type_style_lang-22d432d6.js";import{I as we,C as Yt,M as qe}from"./ModifyUpload-59eb49c0.js";import{U as Ot}from"./Upload-1f73107d.js";import{E as Jt}from"./Empty-a0144be7.js";import{D as Pt}from"./Download-e5877791.js";import"./Blocks-daebea91.js";import{U as Vt}from"./UploadText-a59570b1.js";import{E as rl}from"./Image-ae44e625.js";import"./ModifyUpload.svelte_svelte_type_style_lang-ba6baa96.js";function Gt(t){let e,n,l;return{c(){e=K("svg"),n=K("path"),l=K("path"),d(n,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),d(n,"fill","currentColor"),d(l,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),d(l,"fill","currentColor"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(u,r){y(u,e,r),P(e,n),P(e,l)},p:J,i:J,o:J,d(u){u&&C(e)}}}class Qt extends ne{constructor(e){super(),le(this,e,null,Gt,$,{})}}function Zt(t){let e,n,l,u,r,s,a;return{c(){e=K("svg"),n=K("circle"),l=K("circle"),u=K("circle"),r=K("circle"),s=K("circle"),a=K("path"),d(n,"cx","10"),d(n,"cy","12"),d(n,"r","2"),d(n,"fill","currentColor"),d(l,"cx","16"),d(l,"cy","9"),d(l,"r","2"),d(l,"fill","currentColor"),d(u,"cx","22"),d(u,"cy","12"),d(u,"r","2"),d(u,"fill","currentColor"),d(r,"cx","23"),d(r,"cy","18"),d(r,"r","2"),d(r,"fill","currentColor"),d(s,"cx","19"),d(s,"cy","23"),d(s,"r","2"),d(s,"fill","currentColor"),d(a,"fill","currentColor"),d(a,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 32 32")},m(i,_){y(i,e,_),P(e,n),P(e,l),P(e,u),P(e,r),P(e,s),P(e,a)},p:J,i:J,o:J,d(i){i&&C(e)}}}class Kt extends ne{constructor(e){super(),le(this,e,null,Zt,$,{})}}function $t(t){let e,n;return{c(){e=K("svg"),n=K("path"),d(n,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","100%"),d(e,"height","100%"),d(e,"viewBox","0 0 24 24"),d(e,"fill","none"),d(e,"stroke","currentColor"),d(e,"stroke-width","1.5"),d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"class","feather feather-edit-2")},m(l,u){y(l,e,u),P(e,n)},p:J,i:J,o:J,d(l){l&&C(e)}}}let xe=class extends ne{constructor(e){super(),le(this,e,null,$t,$,{})}};const It=t=>{let e=t.currentTarget;const n=e.getBoundingClientRect(),l=e.naturalWidth/n.width,u=e.naturalHeight/n.height;if(l>u){n.width;const a=e.naturalHeight/l,i=(n.height-a)/2;var r=Math.round((t.clientX-n.left)*l),s=Math.round((t.clientY-n.top-i)*l)}else{const a=e.naturalWidth/u;n.height;const i=(n.width-a)/2;var r=Math.round((t.clientX-n.left-i)*u),s=Math.round((t.clientY-n.top)*u)}return r<0||r>=e.naturalWidth||s<0||s>=e.naturalHeight?null:[r,s]};function xt(t){let e,n;return{c(){e=H("img"),V(e.src,n=t[0])||d(e,"src",n),d(e,"alt","")},m(l,u){y(l,e,u),t[4](e)},p(l,[u]){u&1&&!V(e.src,n=l[0])&&d(e,"src",n)},i:J,o:J,d(l){l&&C(e),t[4](null)}}}function en(t,e,n){let{image:l}=e,u;const r=ge();let s;function a(){s.destroy()}function i(){s&&a(),s=new Nt(u,{autoCropArea:1,cropend(){const o=s.getCroppedCanvas().toDataURL();r("crop",o)}}),r("crop",l)}function _(o){L[o?"unshift":"push"](()=>{u=o,n(1,u)})}return t.$$set=o=>{"image"in o&&n(0,l=o.image)},[l,u,a,i,_]}class yt extends ne{constructor(e){super(),le(this,e,en,xt,$,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),Ct()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class et{constructor(e,n){this.x=e,this.y=n}}class tt extends et{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,n){const l=e+Math.PI/2;this.x=this.x+Math.sin(l)*n,this.y=this.y-Math.cos(l)*n}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new et(this.x-e.x,this.y-e.y)}getDistanceTo(e){const n=this.getDifferenceTo(e);return Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}getAngleTo(e){const n=this.getDifferenceTo(e);return Math.atan2(n.y,n.x)}toObject(){return{x:this.x,y:this.y}}}const tn=30;class nn{constructor({radius:e=tn,enabled:n=!0,initialPoint:l={x:0,y:0}}={}){this.radius=e,this._isEnabled=n,this.pointer=new tt(l.x,l.y),this.brush=new tt(l.x,l.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:n=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!n?!1:(this.pointer.update(e),n?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}function nt(t,e,n){const l=t.slice();return l[59]=e[n].name,l[60]=e[n].zIndex,l[61]=e,l[62]=n,l}function lt(t){let e,n,l;return{c(){e=H("div"),e.textContent="Start drawing",d(e,"class","start-prompt svelte-yigbas")},m(u,r){y(u,e,r),l=!0},i(u){l||(Ve(()=>{l&&(n||(n=Ke(e,$e,{duration:50},!0)),n.run(1))}),l=!0)},o(u){n||(n=Ke(e,$e,{duration:50},!1)),n.run(0),l=!1},d(u){u&&C(e),u&&n&&n.end()}}}function st(t){let e,n=t[59],l,u;const r=()=>t[29](e,n),s=()=>t[29](null,n);return{c(){e=H("canvas"),d(e,"key",t[59]),Tt(e,"z-index",t[60]),d(e,"class","svelte-yigbas"),R(e,"lr",t[5]),R(e,"tb",!t[5])},m(a,i){y(a,e,i),r(),l||(u=[N(e,"mousedown",t[59]==="interface"?t[7]:void 0),N(e,"mousemove",t[59]==="interface"?t[8]:void 0),N(e,"mouseup",t[59]==="interface"?t[9]:void 0),N(e,"mouseout",t[59]==="interface"?t[9]:void 0),N(e,"blur",t[59]==="interface"?t[9]:void 0),N(e,"touchstart",t[59]==="interface"?t[7]:void 0),N(e,"touchmove",t[59]==="interface"?t[8]:void 0),N(e,"touchend",t[59]==="interface"?t[9]:void 0),N(e,"touchcancel",t[59]==="interface"?t[9]:void 0),N(e,"click",Bt(t[28]))],l=!0)},p(a,i){t=a,n!==t[59]&&(s(),n=t[59],r()),i[0]&32&&R(e,"lr",t[5]),i[0]&32&&R(e,"tb",!t[5])},d(a){a&&C(e),s(),l=!1,wt(u)}}}function ln(t){let e,n,l,u,r=t[4]===0&&lt(),s=t[6],a=[];for(let i=0;i<s.length;i+=1)a[i]=st(nt(t,s,i));return{c(){e=H("div"),r&&r.c(),n=F();for(let i=0;i<a.length;i+=1)a[i].c();d(e,"class","wrap svelte-yigbas"),Ve(()=>t[31].call(e))},m(i,_){y(i,e,_),r&&r.m(e,null),P(e,n);for(let o=0;o<a.length;o+=1)a[o]&&a[o].m(e,null);t[30](e),l=kt(e,t[31].bind(e)),u=!0},p(i,_){if(i[4]===0?r?_[0]&16&&p(r,1):(r=lt(),r.c(),p(r,1),r.m(e,n)):r&&(x(),A(r,1,1,()=>{r=null}),ee()),_[0]&993){s=i[6];let o;for(o=0;o<s.length;o+=1){const g=nt(i,s,o);a[o]?a[o].p(g,_):(a[o]=st(g),a[o].c(),a[o].m(e,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=s.length}},i(i){u||(p(r),u=!0)},o(i){A(r),u=!1},d(i){i&&C(e),r&&r.d(),vt(a,i),t[30](null),l()}}}let sn="#aaa";function it(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function rn(t,e,n){let l;const u=ge();let{value:r}=e,{value_img:s}=e,{mode:a="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:_}=e,{source:o}=e,{width:g=400}=e,{height:f=200}=e,{container_height:c=200}=e,{shape:b}=e,I,q=g,X=f,U;const ce=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let E={},k={},W=[],Y=[],se=!0,oe=!0,ie=!1,re=!1,O=null,j=null,Z=null,te=0;function w(){if(!b){k.temp.drawImage(s,0,0,g,f);return}let m=s.naturalWidth,v=s.naturalHeight;const M=b[0]/b[1],T=m/v;let h=0,D=0;M<T?(m=b[1]*T,v=b[1],h=(b[0]-m)/2):M>T?(m=b[0],v=b[0]/T,D=(b[1]-v)/2):(h=0,D=0,m=b[0],v=b[1]),k.temp.drawImage(s,h,D,m,v)}pt(async()=>{Object.keys(E).forEach(m=>{n(25,k[m]=E[m].getContext("2d"),k)}),await de(),s&&(s.addEventListener("load",m=>{o==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):w(),k.drawing.drawImage(E.temp,0,0,g,f),fe()}),setTimeout(()=>{o==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):w(),k.drawing.drawImage(E.temp,0,0,g,f),be({lines:Y.slice()}),fe()},100)),n(27,O=new nn({radius:_*.05,enabled:!0,initialPoint:{x:g/2,y:f/2}})),Z=new Ht((m,v,...M)=>{Me()}),Z.observe(j),ke(),n(23,I=!0),requestAnimationFrame(()=>{ue(),requestAnimationFrame(()=>{me()})})});function ue(){const m=g/2,v=f/2;O.update({x:m,y:v},{both:!0}),O.update({x:m,y:v},{both:!1}),se=!0,oe=!0}Mt(()=>{n(23,I=!1),Z.unobserve(j)});function Fe(){const m=Y.slice(0,-1);De(),s&&(o==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):w(),(!Y||!Y.length)&&k.drawing.drawImage(E.temp,0,0,g,f)),be({lines:m}),n(4,te=m.length),Y.length&&n(26,Y=m),Y.length==0&&u("clear"),fe()}let be=({lines:m})=>{m.forEach(v=>{const{points:M,brush_color:T,brush_radius:h}=v;ze({points:M,brush_color:T,brush_radius:h}),a==="mask"&&Se({points:M,brush_color:T,brush_radius:h}),W=M}),Re(),a==="mask"&&Ee()},Ne=m=>{m.preventDefault(),re=!0;const{x:v,y:M}=Te(m);m.touches&&m.touches.length>0&&O.update({x:v,y:M},{both:!0}),Be(v,M),n(4,te+=1)},Ae=m=>{m.preventDefault();const{x:v,y:M}=Te(m);Be(v,M)},He=m=>{m.preventDefault(),Ae(m),ie=!1,re=!1,Re(),a==="mask"&&Ee()},Ie=0,ye=0,Ce=0,ve=!1,Me=async()=>{if(b&&j){const M=j?.getBoundingClientRect(),T=b[0]/b[1],h=M.width/M.height;n(5,ve=T<h)}if(g===Ie&&f===ye&&Ce===c)return;const m={width:g,height:f},v={height:c,width:c*(m.width/m.height)};await Promise.all([he(E.interface,m,v),he(E.drawing,m,v),he(E.temp,m,v),he(E.temp_fake,m,v),he(E.mask,m,v,!1)]),_||n(10,_=20*(m.width/v.width)),ke({once:!0}),setTimeout(()=>{ye=f,Ie=g,Ce=c},10),await de(),me()},he=async(m,v,M,T=!0)=>{if(!I)return;await de();const h=window.devicePixelRatio||1;m.width=v.width*(T?h:1),m.height=v.height*(T?h:1);const D=m.getContext("2d");T&&D.scale(h,h),m.style.width=`${M.width}px`,m.style.height=`${M.height}px`},Te=m=>{const v=E.interface.getBoundingClientRect();let M=m.clientX,T=m.clientY;return m.changedTouches&&m.changedTouches.length>0&&(M=m.changedTouches[0].clientX,T=m.changedTouches[0].clientY),{x:(M-v.left)/v.width*g,y:(T-v.top)/v.height*f}},Be=(m,v)=>{O.update({x:m,y:v});const M=!O.isEnabled();(re&&!ie||M&&re)&&(ie=!0,W.push(O.brush.toObject())),ie&&(W.push(O.brush.toObject()),ze({points:W,brush_color:i,brush_radius:_}),a==="mask"&&Se({points:W,brush_color:i,brush_radius:_})),se=!0},ze=({points:m,brush_color:v,brush_radius:M})=>{if(!m||m.length<2||(n(25,k.temp.lineJoin="round",k),n(25,k.temp.lineCap="round",k),n(25,k.temp.strokeStyle=v,k),n(25,k.temp.lineWidth=M,k),!m||m.length<2))return;let T=m[0],h=m[1];k.temp.moveTo(h.x,h.y),k.temp.beginPath();for(var D=1,Pe=m.length;D<Pe;D++){var pe=it(T,h);k.temp.quadraticCurveTo(T.x,T.y,pe.x,pe.y),T=m[D],h=m[D+1]}k.temp.lineTo(T.x,T.y),k.temp.stroke()},Se=({points:m,brush_color:v,brush_radius:M})=>{if(!m||m.length<2)return;n(25,k.temp_fake.lineJoin="round",k),n(25,k.temp_fake.lineCap="round",k),n(25,k.temp_fake.strokeStyle="#fff",k),n(25,k.temp_fake.lineWidth=M,k);let T=m[0],h=m[1];k.temp_fake.moveTo(h.x,h.y),k.temp_fake.beginPath();for(var D=1,Pe=m.length;D<Pe;D++){var pe=it(T,h);k.temp_fake.quadraticCurveTo(T.x,T.y,pe.x,pe.y),T=m[D],h=m[D+1]}k.temp_fake.lineTo(T.x,T.y),k.temp_fake.stroke()},Ee=()=>{W.length<1||(W.length=0,k.mask.drawImage(E.temp_fake,0,0,g,f),fe())},Re=()=>{W.length<1||(Y.push({points:W.slice(),brush_color:i,brush_radius:_}),a!=="mask"&&(W.length=0),k.drawing.drawImage(E.temp,0,0,g,f),fe())},fe=()=>{const m=Le();u("change",m)};function me(){return n(26,Y=[]),De(),n(4,te=0),!0}function De(){oe=!0,k.temp.clearRect(0,0,g,f),n(25,k.temp.fillStyle=a==="mask"?"transparent":"#FFFFFF",k),k.temp.fillRect(0,0,g,f),a==="mask"&&(k.temp_fake.clearRect(0,0,E.temp_fake.width,E.temp_fake.height),k.mask.clearRect(0,0,g,f),n(25,k.mask.fillStyle="#000",k),k.mask.fillRect(0,0,g,f))}let ke=({once:m=!1}={})=>{if(se||oe){const v=O.getPointerCoordinates(),M=O.getBrushCoordinates();We(k.interface,v,M),se=!1,oe=!1}m||window.requestAnimationFrame(()=>{ke()})},We=(m,v,M)=>{m.clearRect(0,0,g,f),m.beginPath(),m.fillStyle=i,m.arc(M.x,M.y,_/2,0,Math.PI*2,!0),m.fill(),m.beginPath(),m.fillStyle=sn,m.arc(M.x,M.y,l,0,Math.PI*2,!0),m.fill()};function Le(){return a==="mask"?E.mask.toDataURL("image/jpg"):E.drawing.toDataURL("image/jpg")}function Xe(m){ae.call(this,t,m)}function Ye(m,v){L[m?"unshift":"push"](()=>{E[v]=m,n(0,E)})}function Oe(m){L[m?"unshift":"push"](()=>{j=m,n(3,j)})}function Je(){q=this.offsetWidth,X=this.offsetHeight,n(1,q),n(2,X)}return t.$$set=m=>{"value"in m&&n(13,r=m.value),"value_img"in m&&n(14,s=m.value_img),"mode"in m&&n(15,a=m.mode),"brush_color"in m&&n(16,i=m.brush_color),"brush_radius"in m&&n(10,_=m.brush_radius),"source"in m&&n(17,o=m.source),"width"in m&&n(11,g=m.width),"height"in m&&n(12,f=m.height),"container_height"in m&&n(18,c=m.container_height),"shape"in m&&n(19,b=m.shape)},t.$$.update=()=>{t.$$.dirty[0]&530432&&b&&(g||f)&&(n(11,g=b[0]),n(12,f=b[1])),t.$$.dirty[0]&8396800&&I&&!r&&me(),t.$$.dirty[0]&125982721&&I&&s!==U&&(n(24,U=s),me(),setTimeout(()=>{o==="webcam"?(k.temp.save(),k.temp.translate(g,0),k.temp.scale(-1,1),k.temp.drawImage(s,0,0),k.temp.restore()):w(),k.drawing.drawImage(E.temp,0,0,g,f),be({lines:Y.slice()}),fe()},50)),t.$$.dirty[0]&134218752&&O&&(ue(),O.setRadius(_*.05)),t.$$.dirty[0]&6144&&(g||f)&&Me(),t.$$.dirty[0]&1024&&(l=_*.075)},[E,q,X,j,te,ve,ce,Ne,Ae,He,_,g,f,r,s,a,i,o,c,b,Fe,me,Le,I,U,k,Y,O,Xe,Ye,Oe,Je]}class Ge extends ne{constructor(e){super(),le(this,e,rn,ln,$,{value:13,value_img:14,mode:15,brush_color:16,brush_radius:10,source:17,width:11,height:12,container_height:18,shape:19,undo:20,clear:21,get_image_data:22},null,[-1,-1,-1])}get undo(){return this.$$.ctx[20]}get clear(){return this.$$.ctx[21]}get get_image_data(){return this.$$.ctx[22]}}function un(t){let e,n,l,u,r;return n=new we({props:{Icon:Wt,label:"Undo"}}),n.$on("click",t[1]),u=new we({props:{Icon:Yt,label:"Clear"}}),u.$on("click",t[2]),{c(){e=H("div"),B(n.$$.fragment),l=F(),B(u.$$.fragment),d(e,"class","svelte-s6ybro")},m(s,a){y(s,e,a),z(n,e,null),P(e,l),z(u,e,null),r=!0},p:J,i(s){r||(p(n.$$.fragment,s),p(u.$$.fragment,s),r=!0)},o(s){A(n.$$.fragment,s),A(u.$$.fragment,s),r=!1},d(s){s&&C(e),S(n),S(u)}}}function an(t){const e=ge();return[e,()=>e("undo"),u=>{e("clear"),u.stopPropagation()}]}class Qe extends ne{constructor(e){super(),le(this,e,an,un,$,{})}}function rt(t){let e,n,l,u,r;return{c(){e=H("input"),d(e,"aria-label","Brush radius"),d(e,"type","range"),d(e,"min",n=.5*(t[2]/t[6])),d(e,"max",l=75*(t[2]/t[6])),d(e,"class","svelte-p4aq0j")},m(s,a){y(s,e,a),Ue(e,t[0]),u||(r=[N(e,"change",t[10]),N(e,"input",t[10])],u=!0)},p(s,a){a&68&&n!==(n=.5*(s[2]/s[6]))&&d(e,"min",n),a&68&&l!==(l=75*(s[2]/s[6]))&&d(e,"max",l),a&1&&Ue(e,s[0])},d(s){s&&C(e),u=!1,wt(r)}}}function ut(t){let e,n,l,u;n=new we({props:{Icon:Kt,label:"Select brush color"}}),n.$on("click",t[11]);let r=t[5]&&at(t);return{c(){e=H("span"),B(n.$$.fragment),l=F(),r&&r.c(),d(e,"class","col svelte-p4aq0j")},m(s,a){y(s,e,a),z(n,e,null),P(e,l),r&&r.m(e,null),u=!0},p(s,a){s[5]?r?r.p(s,a):(r=at(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i(s){u||(p(n.$$.fragment,s),u=!0)},o(s){A(n.$$.fragment,s),u=!1},d(s){s&&C(e),S(n),r&&r.d()}}}function at(t){let e,n,l;return{c(){e=H("input"),d(e,"aria-label","Brush color"),d(e,"type","color"),d(e,"class","svelte-p4aq0j")},m(u,r){y(u,e,r),Ue(e,t[1]),n||(l=N(e,"input",t[12]),n=!0)},p(u,r){r&2&&Ue(e,u[1])},d(u){u&&C(e),n=!1,l()}}}function on(t){let e,n,l,u,r,s;l=new we({props:{Icon:Qt,label:"Use brush"}}),l.$on("click",t[9]);let a=t[4]&&rt(t),i=t[3]!=="mask"&&ut(t);return{c(){e=H("div"),n=H("span"),B(l.$$.fragment),u=F(),a&&a.c(),r=F(),i&&i.c(),d(n,"class","brush svelte-p4aq0j"),d(e,"class","wrap svelte-p4aq0j")},m(_,o){y(_,e,o),P(e,n),z(l,n,null),P(n,u),a&&a.m(n,null),P(e,r),i&&i.m(e,null),s=!0},p(_,[o]){_[4]?a?a.p(_,o):(a=rt(_),a.c(),a.m(n,null)):a&&(a.d(1),a=null),_[3]!=="mask"?i?(i.p(_,o),o&8&&p(i,1)):(i=ut(_),i.c(),p(i,1),i.m(e,null)):i&&(x(),A(i,1,1,()=>{i=null}),ee())},i(_){s||(p(l.$$.fragment,_),p(i),s=!0)},o(_){A(l.$$.fragment,_),A(i),s=!1},d(_){_&&C(e),S(l),a&&a.d(),i&&i.d()}}}function fn(t,e,n){let l;ge();let u=!1,r=!1,{brush_radius:s=20}=e,{brush_color:a="#000"}=e,{container_height:i}=e,{img_width:_}=e,{img_height:o}=e,{mode:g="other"}=e;const f=()=>n(4,u=!u);function c(){s=zt(this.value),n(0,s)}const b=()=>n(5,r=!r);function I(){a=this.value,n(1,a)}return t.$$set=q=>{"brush_radius"in q&&n(0,s=q.brush_radius),"brush_color"in q&&n(1,a=q.brush_color),"container_height"in q&&n(7,i=q.container_height),"img_width"in q&&n(2,_=q.img_width),"img_height"in q&&n(8,o=q.img_height),"mode"in q&&n(3,g=q.mode)},t.$$.update=()=>{t.$$.dirty&388&&n(6,l=i*(_/o))},[s,a,_,g,u,r,l,i,o,f,c,b,I]}class Ze extends ne{constructor(e){super(),le(this,e,fn,on,$,{brush_radius:0,brush_color:1,container_height:7,img_width:2,img_height:8,mode:3})}}function _n(t){let e,n,l,u;return{c(){e=H("img"),V(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt",""),d(e,"class","svelte-p3y7hu"),R(e,"webcam",t[5]==="webcam"&&t[9]),R(e,"selectable",t[10])},m(r,s){y(r,e,s),l||(u=N(e,"click",t[28]),l=!0)},p(r,s){s[0]&1&&!V(e.src,n=r[0].image||r[0])&&d(e,"src",n),s[0]&544&&R(e,"webcam",r[5]==="webcam"&&r[9]),s[0]&1024&&R(e,"selectable",r[10])},i:J,o:J,d(r){r&&C(e),l=!1,u()}}}function cn(t){let e=t[21],n,l,u,r=ot(t),s=t[16]>0&&ft(t);return{c(){r.c(),n=F(),s&&s.c(),l=_e()},m(a,i){r.m(a,i),y(a,n,i),s&&s.m(a,i),y(a,l,i),u=!0},p(a,i){i[0]&2097152&&$(e,e=a[21])?(r.d(1),r=ot(a),r.c(),r.m(n.parentNode,n)):r.p(a,i),a[16]>0?s?(s.p(a,i),i[0]&65536&&p(s,1)):(s=ft(a),s.c(),p(s,1),s.m(l.parentNode,l)):s&&(x(),A(s,1,1,()=>{s=null}),ee())},i(a){u||(p(s),u=!0)},o(a){A(s),u=!1},d(a){r.d(a),a&&C(n),s&&s.d(a),a&&C(l)}}}function hn(t){let e,n,l,u,r,s,a;return e=new qe({props:{editable:!0}}),e.$on("edit",t[51]),e.$on("clear",t[24]),{c(){B(e.$$.fragment),n=F(),l=H("img"),V(l.src,u=t[0])||d(l,"src",u),d(l,"alt",""),d(l,"class","svelte-p3y7hu"),R(l,"selectable",t[10]),R(l,"webcam",t[5]==="webcam"&&t[9])},m(i,_){z(e,i,_),y(i,n,_),y(i,l,_),r=!0,s||(a=N(l,"click",t[28]),s=!0)},p(i,_){(!r||_[0]&1&&!V(l.src,u=i[0]))&&d(l,"src",u),(!r||_[0]&1024)&&R(l,"selectable",i[10]),(!r||_[0]&544)&&R(l,"webcam",i[5]==="webcam"&&i[9])},i(i){r||(p(e.$$.fragment,i),r=!0)},o(i){A(e.$$.fragment,i),r=!1},d(i){S(e,i),i&&C(n),i&&C(l),s=!1,a()}}}function mn(t){let e,n,l,u,r={image:t[0]};return e=new yt({props:r}),t[49](e),e.$on("crop",t[25]),l=new qe({}),l.$on("clear",t[50]),{c(){B(e.$$.fragment),n=F(),B(l.$$.fragment)},m(s,a){z(e,s,a),y(s,n,a),z(l,s,a),u=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){u||(p(e.$$.fragment,s),p(l.$$.fragment,s),u=!0)},o(s){A(e.$$.fragment,s),A(l.$$.fragment,s),u=!1},d(s){t[49](null),S(e,s),s&&C(n),S(l,s)}}}function gn(t){let e,n,l=t[5]==="webcam"&&!t[21]&&ct(t);return{c(){l&&l.c(),e=_e()},m(u,r){l&&l.m(u,r),y(u,e,r),n=!0},p(u,r){u[5]==="webcam"&&!u[21]?l?(l.p(u,r),r[0]&2097184&&p(l,1)):(l=ct(u),l.c(),p(l,1),l.m(e.parentNode,e)):l&&(x(),A(l,1,1,()=>{l=null}),ee())},i(u){n||(p(l),n=!0)},o(u){A(l),n=!1},d(u){l&&l.d(u),u&&C(e)}}}function dn(t){let e,n,l,u,r,s,a;e=new Qe({}),e.$on("undo",t[41]),e.$on("clear",t[27]);let i=t[1]==="color-sketch"&&ht(t);function _(f){t[44](f)}function o(f){t[45](f)}let g={value:t[0],mode:t[13],width:t[16]||t[20],height:t[15]||t[19],container_height:t[17]||t[19],shape:t[6]};return t[2]!==void 0&&(g.brush_radius=t[2]),t[22]!==void 0&&(g.brush_color=t[22]),u=new Ge({props:g}),L.push(()=>G(u,"brush_radius",_)),L.push(()=>G(u,"brush_color",o)),t[46](u),u.$on("change",t[25]),u.$on("clear",t[27]),{c(){B(e.$$.fragment),n=F(),i&&i.c(),l=F(),B(u.$$.fragment)},m(f,c){z(e,f,c),y(f,n,c),i&&i.m(f,c),y(f,l,c),z(u,f,c),a=!0},p(f,c){f[1]==="color-sketch"?i?(i.p(f,c),c[0]&2&&p(i,1)):(i=ht(f),i.c(),p(i,1),i.m(l.parentNode,l)):i&&(x(),A(i,1,1,()=>{i=null}),ee());const b={};c[0]&1&&(b.value=f[0]),c[0]&8192&&(b.mode=f[13]),c[0]&1114112&&(b.width=f[16]||f[20]),c[0]&557056&&(b.height=f[15]||f[19]),c[0]&655360&&(b.container_height=f[17]||f[19]),c[0]&64&&(b.shape=f[6]),!r&&c[0]&4&&(r=!0,b.brush_radius=f[2],Q(()=>r=!1)),!s&&c[0]&4194304&&(s=!0,b.brush_color=f[22],Q(()=>s=!1)),u.$set(b)},i(f){a||(p(e.$$.fragment,f),p(i),p(u.$$.fragment,f),a=!0)},o(f){A(e.$$.fragment,f),A(i),A(u.$$.fragment,f),a=!1},d(f){S(e,f),f&&C(n),i&&i.d(f),f&&C(l),t[46](null),S(u,f)}}}function bn(t){let e,n,l;function u(s){t[40](s)}let r={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[yn]},$$scope:{ctx:t}};return t[12]!==void 0&&(r.dragging=t[12]),e=new Ot({props:r}),L.push(()=>G(e,"dragging",u)),e.$on("load",t[23]),{c(){B(e.$$.fragment)},m(s,a){z(e,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.disable_click=!!s[0]),a[0]&8384231|a[1]&536870912&&(i.$$scope={dirty:a,ctx:s}),!n&&a[0]&4096&&(n=!0,i.dragging=s[12],Q(()=>n=!1)),e.$set(i)},i(s){l||(p(e.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),l=!1},d(s){S(e,s)}}}function ot(t){let e,n,l,u;return{c(){e=H("img"),d(e,"class","absolute-img svelte-p3y7hu"),V(e.src,n=t[21]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),R(e,"webcam",t[5]==="webcam"&&t[9])},m(r,s){y(r,e,s),t[52](e),l||(u=N(e,"load",t[26]),l=!0)},p(r,s){s[0]&2097153&&!V(e.src,n=r[21]||r[0]?.image||r[0])&&d(e,"src",n),s[0]&544&&R(e,"webcam",r[5]==="webcam"&&r[9])},d(r){r&&C(e),t[52](null),l=!1,u()}}}function ft(t){let e,n,l,u,r,s,a,i;function _(c){t[54](c)}function o(c){t[55](c)}let g={value:t[0],mode:t[13],width:t[16]||t[20],height:t[15]||t[19],container_height:t[17]||t[19],value_img:t[18],source:t[5]};t[2]!==void 0&&(g.brush_radius=t[2]),t[22]!==void 0&&(g.brush_color=t[22]),e=new Ge({props:g}),t[53](e),L.push(()=>G(e,"brush_radius",_)),L.push(()=>G(e,"brush_color",o)),e.$on("change",t[25]),r=new Qe({}),r.$on("undo",t[56]),r.$on("clear",t[27]);let f=(t[1]==="color-sketch"||t[1]==="sketch")&&_t(t);return{c(){B(e.$$.fragment),u=F(),B(r.$$.fragment),s=F(),f&&f.c(),a=_e()},m(c,b){z(e,c,b),y(c,u,b),z(r,c,b),y(c,s,b),f&&f.m(c,b),y(c,a,b),i=!0},p(c,b){const I={};b[0]&1&&(I.value=c[0]),b[0]&8192&&(I.mode=c[13]),b[0]&1114112&&(I.width=c[16]||c[20]),b[0]&557056&&(I.height=c[15]||c[19]),b[0]&655360&&(I.container_height=c[17]||c[19]),b[0]&262144&&(I.value_img=c[18]),b[0]&32&&(I.source=c[5]),!n&&b[0]&4&&(n=!0,I.brush_radius=c[2],Q(()=>n=!1)),!l&&b[0]&4194304&&(l=!0,I.brush_color=c[22],Q(()=>l=!1)),e.$set(I),c[1]==="color-sketch"||c[1]==="sketch"?f?(f.p(c,b),b[0]&2&&p(f,1)):(f=_t(c),f.c(),p(f,1),f.m(a.parentNode,a)):f&&(x(),A(f,1,1,()=>{f=null}),ee())},i(c){i||(p(e.$$.fragment,c),p(r.$$.fragment,c),p(f),i=!0)},o(c){A(e.$$.fragment,c),A(r.$$.fragment,c),A(f),i=!1},d(c){t[53](null),S(e,c),c&&C(u),S(r,c),c&&C(s),f&&f.d(c),c&&C(a)}}}function _t(t){let e,n,l,u;function r(i){t[57](i)}function s(i){t[58](i)}let a={container_height:t[17]||t[19],img_width:t[16]||t[20],img_height:t[15]||t[19],mode:t[13]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[22]!==void 0&&(a.brush_color=t[22]),e=new Ze({props:a}),L.push(()=>G(e,"brush_radius",r)),L.push(()=>G(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(i,_){z(e,i,_),u=!0},p(i,_){const o={};_[0]&655360&&(o.container_height=i[17]||i[19]),_[0]&1114112&&(o.img_width=i[16]||i[20]),_[0]&557056&&(o.img_height=i[15]||i[19]),_[0]&8192&&(o.mode=i[13]),!n&&_[0]&4&&(n=!0,o.brush_radius=i[2],Q(()=>n=!1)),!l&&_[0]&4194304&&(l=!0,o.brush_color=i[22],Q(()=>l=!1)),e.$set(o)},i(i){u||(p(e.$$.fragment,i),u=!0)},o(i){A(e.$$.fragment,i),u=!1},d(i){S(e,i)}}}function ct(t){let e,n;return e=new Xt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[47]),e.$on("stream",t[25]),e.$on("error",t[48]),{c(){B(e.$$.fragment)},m(l,u){z(e,l,u),n=!0},p(l,u){const r={};u[0]&128&&(r.streaming=l[7]),u[0]&256&&(r.pending=l[8]),u[0]&512&&(r.mirror_webcam=l[9]),e.$set(r)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function ht(t){let e,n,l,u;function r(i){t[42](i)}function s(i){t[43](i)}let a={container_height:t[17]||t[19],img_width:t[16]||t[20],img_height:t[15]||t[19]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[22]!==void 0&&(a.brush_color=t[22]),e=new Ze({props:a}),L.push(()=>G(e,"brush_radius",r)),L.push(()=>G(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(i,_){z(e,i,_),u=!0},p(i,_){const o={};_[0]&655360&&(o.container_height=i[17]||i[19]),_[0]&1114112&&(o.img_width=i[16]||i[20]),_[0]&557056&&(o.img_height=i[15]||i[19]),!n&&_[0]&4&&(n=!0,o.brush_radius=i[2],Q(()=>n=!1)),!l&&_[0]&4194304&&(l=!0,o.brush_color=i[22],Q(()=>l=!1)),e.$set(o)},i(i){u||(p(e.$$.fragment,i),u=!0)},o(i){A(e.$$.fragment,i),u=!1},d(i){S(e,i)}}}function kn(t){let e,n,l,u;return{c(){e=H("img"),V(e.src,n=t[0].image||t[0])||d(e,"src",n),d(e,"alt","hello"),d(e,"class","svelte-p3y7hu"),R(e,"webcam",t[5]==="webcam"&&t[9]),R(e,"selectable",t[10])},m(r,s){y(r,e,s),l||(u=N(e,"click",t[28]),l=!0)},p(r,s){s[0]&1&&!V(e.src,n=r[0].image||r[0])&&d(e,"src",n),s[0]&544&&R(e,"webcam",r[5]==="webcam"&&r[9]),s[0]&1024&&R(e,"selectable",r[10])},i:J,o:J,d(r){r&&C(e),l=!1,u()}}}function pn(t){let e=t[21],n,l,u,r=mt(t),s=t[16]>0&&gt(t);return{c(){r.c(),n=F(),s&&s.c(),l=_e()},m(a,i){r.m(a,i),y(a,n,i),s&&s.m(a,i),y(a,l,i),u=!0},p(a,i){i[0]&2097152&&$(e,e=a[21])?(r.d(1),r=mt(a),r.c(),r.m(n.parentNode,n)):r.p(a,i),a[16]>0?s?(s.p(a,i),i[0]&65536&&p(s,1)):(s=gt(a),s.c(),p(s,1),s.m(l.parentNode,l)):s&&(x(),A(s,1,1,()=>{s=null}),ee())},i(a){u||(p(s),u=!0)},o(a){A(s),u=!1},d(a){r.d(a),a&&C(n),s&&s.d(a),a&&C(l)}}}function wn(t){let e,n,l,u,r,s,a;return e=new qe({props:{editable:!0}}),e.$on("edit",t[32]),e.$on("clear",t[24]),{c(){B(e.$$.fragment),n=F(),l=H("img"),V(l.src,u=t[0])||d(l,"src",u),d(l,"alt",""),d(l,"class","svelte-p3y7hu"),R(l,"scale-x-[-1]",t[5]==="webcam"&&t[9]),R(l,"selectable",t[10])},m(i,_){z(e,i,_),y(i,n,_),y(i,l,_),r=!0,s||(a=N(l,"click",t[28]),s=!0)},p(i,_){(!r||_[0]&1&&!V(l.src,u=i[0]))&&d(l,"src",u),(!r||_[0]&544)&&R(l,"scale-x-[-1]",i[5]==="webcam"&&i[9]),(!r||_[0]&1024)&&R(l,"selectable",i[10])},i(i){r||(p(e.$$.fragment,i),r=!0)},o(i){A(e.$$.fragment,i),r=!1},d(i){S(e,i),i&&C(n),i&&C(l),s=!1,a()}}}function An(t){let e,n,l,u,r={image:t[0]};return e=new yt({props:r}),t[30](e),e.$on("crop",t[25]),l=new qe({}),l.$on("clear",t[31]),{c(){B(e.$$.fragment),n=F(),B(l.$$.fragment)},m(s,a){z(e,s,a),y(s,n,a),z(l,s,a),u=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){u||(p(e.$$.fragment,s),p(l.$$.fragment,s),u=!0)},o(s){A(e.$$.fragment,s),A(l.$$.fragment,s),u=!1},d(s){t[30](null),S(e,s),s&&C(n),S(l,s)}}}function In(t){let e;const n=t[29].default,l=St(n,t,t[60],null);return{c(){l&&l.c()},m(u,r){l&&l.m(u,r),e=!0},p(u,r){l&&l.p&&(!e||r[1]&536870912)&&Et(l,n,u,u[60],e?Dt(n,u[60],r,null):Rt(u[60]),null)},i(u){e||(p(l,u),e=!0)},o(u){A(l,u),e=!1},d(u){l&&l.d(u)}}}function mt(t){let e,n,l,u;return{c(){e=H("img"),d(e,"class","absolute-img svelte-p3y7hu"),V(e.src,n=t[21]||t[0]?.image||t[0])||d(e,"src",n),d(e,"alt",""),R(e,"webcam",t[5]==="webcam"&&t[9])},m(r,s){y(r,e,s),t[33](e),l||(u=N(e,"load",t[26]),l=!0)},p(r,s){s[0]&2097153&&!V(e.src,n=r[21]||r[0]?.image||r[0])&&d(e,"src",n),s[0]&544&&R(e,"webcam",r[5]==="webcam"&&r[9])},d(r){r&&C(e),t[33](null),l=!1,u()}}}function gt(t){let e,n,l,u,r,s,a,i;function _(c){t[35](c)}function o(c){t[36](c)}let g={value:t[0],mode:t[13],width:t[16]||t[20],height:t[15]||t[19],container_height:t[17]||t[19],value_img:t[18],source:t[5],shape:t[6]};t[2]!==void 0&&(g.brush_radius=t[2]),t[22]!==void 0&&(g.brush_color=t[22]),e=new Ge({props:g}),t[34](e),L.push(()=>G(e,"brush_radius",_)),L.push(()=>G(e,"brush_color",o)),e.$on("change",t[25]),r=new Qe({}),r.$on("undo",t[37]),r.$on("clear",t[27]);let f=(t[1]==="color-sketch"||t[1]==="sketch")&&dt(t);return{c(){B(e.$$.fragment),u=F(),B(r.$$.fragment),s=F(),f&&f.c(),a=_e()},m(c,b){z(e,c,b),y(c,u,b),z(r,c,b),y(c,s,b),f&&f.m(c,b),y(c,a,b),i=!0},p(c,b){const I={};b[0]&1&&(I.value=c[0]),b[0]&8192&&(I.mode=c[13]),b[0]&1114112&&(I.width=c[16]||c[20]),b[0]&557056&&(I.height=c[15]||c[19]),b[0]&655360&&(I.container_height=c[17]||c[19]),b[0]&262144&&(I.value_img=c[18]),b[0]&32&&(I.source=c[5]),b[0]&64&&(I.shape=c[6]),!n&&b[0]&4&&(n=!0,I.brush_radius=c[2],Q(()=>n=!1)),!l&&b[0]&4194304&&(l=!0,I.brush_color=c[22],Q(()=>l=!1)),e.$set(I),c[1]==="color-sketch"||c[1]==="sketch"?f?(f.p(c,b),b[0]&2&&p(f,1)):(f=dt(c),f.c(),p(f,1),f.m(a.parentNode,a)):f&&(x(),A(f,1,1,()=>{f=null}),ee())},i(c){i||(p(e.$$.fragment,c),p(r.$$.fragment,c),p(f),i=!0)},o(c){A(e.$$.fragment,c),A(r.$$.fragment,c),A(f),i=!1},d(c){t[34](null),S(e,c),c&&C(u),S(r,c),c&&C(s),f&&f.d(c),c&&C(a)}}}function dt(t){let e,n,l,u;function r(i){t[38](i)}function s(i){t[39](i)}let a={container_height:t[17]||t[19],img_width:t[16]||t[20],img_height:t[15]||t[19],mode:t[13]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[22]!==void 0&&(a.brush_color=t[22]),e=new Ze({props:a}),L.push(()=>G(e,"brush_radius",r)),L.push(()=>G(e,"brush_color",s)),{c(){B(e.$$.fragment)},m(i,_){z(e,i,_),u=!0},p(i,_){const o={};_[0]&655360&&(o.container_height=i[17]||i[19]),_[0]&1114112&&(o.img_width=i[16]||i[20]),_[0]&557056&&(o.img_height=i[15]||i[19]),_[0]&8192&&(o.mode=i[13]),!n&&_[0]&4&&(n=!0,o.brush_radius=i[2],Q(()=>n=!1)),!l&&_[0]&4194304&&(l=!0,o.brush_color=i[22],Q(()=>l=!1)),e.$set(o)},i(i){u||(p(e.$$.fragment,i),u=!0)},o(i){A(e.$$.fragment,i),u=!1},d(i){S(e,i)}}}function yn(t){let e,n,l,u;const r=[In,An,wn,pn,kn],s=[];function a(i,_){return i[0]===null&&!i[21]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[21])?3:4}return e=a(t),n=s[e]=r[e](t),{c(){n.c(),l=_e()},m(i,_){s[e].m(i,_),y(i,l,_),u=!0},p(i,_){let o=e;e=a(i),e===o?s[e].p(i,_):(x(),A(s[o],1,1,()=>{s[o]=null}),ee(),n=s[e],n?n.p(i,_):(n=s[e]=r[e](i),n.c()),p(n,1),n.m(l.parentNode,l))},i(i){u||(p(n),u=!0)},o(i){A(n),u=!1},d(i){s[e].d(i),i&&C(l)}}}function Cn(t){let e,n,l,u,r,s,a;e=new At({props:{show_label:t[4],Icon:t[5]==="canvas"?xe:je,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[bn,dn,gn,mn,hn,cn,_n],_=[];function o(g,f){return g[5]==="upload"?0:g[5]==="canvas"?1:g[0]===null&&!g[21]||g[7]?2:g[1]==="select"?3:g[1]==="editor"?4:(g[1]==="sketch"||g[1]==="color-sketch")&&(g[0]!==null||g[21])?5:6}return u=o(t),r=_[u]=i[u](t),{c(){B(e.$$.fragment),n=F(),l=H("div"),r.c(),d(l,"data-testid","image"),d(l,"class","image-container svelte-p3y7hu"),Ve(()=>t[59].call(l))},m(g,f){z(e,g,f),y(g,n,f),y(g,l,f),_[u].m(l,null),s=kt(l,t[59].bind(l)),a=!0},p(g,f){const c={};f[0]&16&&(c.show_label=g[4]),f[0]&32&&(c.Icon=g[5]==="canvas"?xe:je),f[0]&40&&(c.label=g[3]||(g[5]==="canvas"?"Sketch":"Image")),e.$set(c);let b=u;u=o(g),u===b?_[u].p(g,f):(x(),A(_[b],1,1,()=>{_[b]=null}),ee(),r=_[u],r?r.p(g,f):(r=_[u]=i[u](g),r.c()),p(r,1),r.m(l,null))},i(g){a||(p(e.$$.fragment,g),p(r),a=!0)},o(g){A(e.$$.fragment,g),A(r),a=!1},d(g){S(e,g),g&&C(n),g&&C(l),_[u].d(),s()}}}function vn(t,e,n){let l,{$$slots:u={},$$scope:r}=e,{value:s}=e,{label:a=void 0}=e,{show_label:i}=e,{source:_="upload"}=e,{tool:o="editor"}=e,{shape:g}=e,{streaming:f=!1}=e,{pending:c=!1}=e,{mirror_webcam:b}=e,{brush_radius:I}=e,{selectable:q=!1}=e,X,U;s&&(_==="upload"||_==="webcam")&&o==="sketch"&&(s={image:s,mask:null});function ce({detail:h}){o==="color-sketch"?n(21,ue=h):n(0,s=(_==="upload"||_==="webcam")&&o==="sketch"?{image:h,mask:null}:h),W("upload",h)}function E({detail:h}){n(0,s=null),n(21,ue=void 0),W("clear")}async function k({detail:h},D){j==="mask"?_==="webcam"&&D?n(0,s={image:h,mask:null}):n(0,s={image:typeof s=="string"?s:s?.image||null,mask:h}):(_==="upload"||_==="webcam")&&o==="sketch"?n(0,s={image:h,mask:null}):n(0,s=h),await de(),W(f?"stream":"edit")}const W=ge();let Y=!1;function se(h){const D=h.currentTarget;n(16,re=D.naturalWidth),n(15,ie=D.naturalHeight),n(17,O=D.getBoundingClientRect().height)}async function oe(){X.clear(),await de(),n(0,s=null),n(21,ue=void 0)}let ie=0,re=0,O=0,j,Z,te,w,ue;pt(async()=>{o==="color-sketch"&&s&&typeof s=="string"&&(n(21,ue=s),await de(),se({currentTarget:Z}))});const Fe=h=>{let D=It(h);D&&W("select",{index:D,value:null})};function be(h){L[h?"unshift":"push"](()=>{U=h,n(11,U),n(0,s)})}const Ne=h=>(E(h),n(1,o="editor")),Ae=()=>n(1,o="select");function He(h){L[h?"unshift":"push"](()=>{Z=h,n(18,Z)})}function Ie(h){L[h?"unshift":"push"](()=>{X=h,n(14,X)})}function ye(h){I=h,n(2,I)}function Ce(h){l=h,n(22,l),n(13,j),n(5,_),n(1,o)}const ve=()=>X.undo();function Me(h){I=h,n(2,I)}function he(h){l=h,n(22,l),n(13,j),n(5,_),n(1,o)}function Te(h){Y=h,n(12,Y)}const Be=()=>X.undo();function ze(h){I=h,n(2,I)}function Se(h){l=h,n(22,l),n(13,j),n(5,_),n(1,o)}function Ee(h){I=h,n(2,I)}function Re(h){l=h,n(22,l),n(13,j),n(5,_),n(1,o)}function fe(h){L[h?"unshift":"push"](()=>{X=h,n(14,X)})}const me=h=>o==="color-sketch"?ce(h):k(h,!0);function De(h){ae.call(this,t,h)}function ke(h){L[h?"unshift":"push"](()=>{U=h,n(11,U),n(0,s)})}const We=h=>(E(h),n(1,o="editor")),Le=()=>n(1,o="select");function Xe(h){L[h?"unshift":"push"](()=>{Z=h,n(18,Z)})}function Ye(h){L[h?"unshift":"push"](()=>{X=h,n(14,X)})}function Oe(h){I=h,n(2,I)}function Je(h){l=h,n(22,l),n(13,j),n(5,_),n(1,o)}const m=()=>X.undo();function v(h){I=h,n(2,I)}function M(h){l=h,n(22,l),n(13,j),n(5,_),n(1,o)}function T(){te=this.offsetHeight,w=this.offsetWidth,n(19,te),n(20,w)}return t.$$set=h=>{"value"in h&&n(0,s=h.value),"label"in h&&n(3,a=h.label),"show_label"in h&&n(4,i=h.show_label),"source"in h&&n(5,_=h.source),"tool"in h&&n(1,o=h.tool),"shape"in h&&n(6,g=h.shape),"streaming"in h&&n(7,f=h.streaming),"pending"in h&&n(8,c=h.pending),"mirror_webcam"in h&&n(9,b=h.mirror_webcam),"brush_radius"in h&&n(2,I=h.brush_radius),"selectable"in h&&n(10,q=h.selectable),"$$scope"in h&&n(60,r=h.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&W("change",s),t.$$.dirty[0]&4096&&W("drag",Y),t.$$.dirty[0]&34&&(_==="canvas"&&o==="sketch"?n(13,j="bw-sketch"):o==="color-sketch"?n(13,j="color-sketch"):(_==="upload"||_==="webcam")&&o==="sketch"?n(13,j="mask"):n(13,j="editor")),t.$$.dirty[0]&8192&&n(22,l=j=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&n(21,ue=void 0),t.$$.dirty[0]&2049&&U&&(s?(n(11,U.image=s,U),U.create()):U.destroy())},[s,o,I,a,i,_,g,f,c,b,q,U,Y,j,X,ie,re,O,Z,te,w,ue,l,ce,E,k,se,oe,Fe,u,be,Ne,Ae,He,Ie,ye,Ce,ve,Me,he,Te,Be,ze,Se,Ee,Re,fe,me,De,ke,We,Le,Xe,Ye,Oe,Je,m,v,M,T,r]}let Mn=class extends ne{constructor(e){super(),le(this,e,vn,Cn,$,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2,selectable:10},null,[-1,-1])}};function Tn(t){let e,n,l,u,r,s,a,i,_;return l=new we({props:{Icon:Pt,label:"Download"}}),{c(){e=H("div"),n=H("a"),B(l.$$.fragment),u=F(),r=H("img"),d(n,"href",t[0]),d(n,"target",window.__is_colab__?"_blank":null),d(n,"download","image"),d(e,"class","download svelte-ms5bsk"),V(r.src,s=t[0])||d(r,"src",s),d(r,"alt",""),d(r,"class","svelte-ms5bsk"),R(r,"selectable",t[3])},m(o,g){y(o,e,g),P(e,n),z(l,n,null),y(o,u,g),y(o,r,g),a=!0,i||(_=N(r,"click",t[4]),i=!0)},p(o,g){(!a||g&1)&&d(n,"href",o[0]),(!a||g&1&&!V(r.src,s=o[0]))&&d(r,"src",s),(!a||g&8)&&R(r,"selectable",o[3])},i(o){a||(p(l.$$.fragment,o),a=!0)},o(o){A(l.$$.fragment,o),a=!1},d(o){o&&C(e),S(l),o&&C(u),o&&C(r),i=!1,_()}}}function Bn(t){let e,n;return e=new Jt({props:{size:"large",unpadded_box:!0,$$slots:{default:[zn]},$$scope:{ctx:t}}}),{c(){B(e.$$.fragment)},m(l,u){z(e,l,u),n=!0},p(l,u){const r={};u&64&&(r.$$scope={dirty:u,ctx:l}),e.$set(r)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function zn(t){let e,n;return e=new je({}),{c(){B(e.$$.fragment)},m(l,u){z(e,l,u),n=!0},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function Sn(t){let e,n,l,u,r,s;e=new At({props:{show_label:t[2],Icon:je,label:t[1]||"Image"}});const a=[Bn,Tn],i=[];function _(o,g){return o[0]===null?0:1}return l=_(t),u=i[l]=a[l](t),{c(){B(e.$$.fragment),n=F(),u.c(),r=_e()},m(o,g){z(e,o,g),y(o,n,g),i[l].m(o,g),y(o,r,g),s=!0},p(o,[g]){const f={};g&4&&(f.show_label=o[2]),g&2&&(f.label=o[1]||"Image"),e.$set(f);let c=l;l=_(o),l===c?i[l].p(o,g):(x(),A(i[c],1,1,()=>{i[c]=null}),ee(),u=i[l],u?u.p(o,g):(u=i[l]=a[l](o),u.c()),p(u,1),u.m(r.parentNode,r))},i(o){s||(p(e.$$.fragment,o),p(u),s=!0)},o(o){A(e.$$.fragment,o),A(u),s=!1},d(o){S(e,o),o&&C(n),i[l].d(o),o&&C(r)}}}function En(t,e,n){let{value:l}=e,{label:u=void 0}=e,{show_label:r}=e,{selectable:s=!1}=e;const a=ge(),i=_=>{let o=It(_);o&&a("select",{index:o,value:null})};return t.$$set=_=>{"value"in _&&n(0,l=_.value),"label"in _&&n(1,u=_.label),"show_label"in _&&n(2,r=_.show_label),"selectable"in _&&n(3,s=_.selectable)},t.$$.update=()=>{t.$$.dirty&1&&l&&a("change",l)},[l,u,r,s,i]}class Rn extends ne{constructor(e){super(),le(this,e,En,Sn,$,{value:0,label:1,show_label:2,selectable:3})}}function Dn(t){let e,n,l;function u(s){t[19](s)}let r={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],selectable:t[15],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Un]},$$scope:{ctx:t}};return t[0]!==void 0&&(r.value=t[0]),e=new Mn({props:r}),L.push(()=>G(e,"value",u)),e.$on("edit",t[20]),e.$on("clear",t[21]),e.$on("change",t[22]),e.$on("stream",t[23]),e.$on("drag",t[24]),e.$on("upload",t[25]),e.$on("select",t[26]),e.$on("error",t[27]),{c(){B(e.$$.fragment)},m(s,a){z(e,s,a),l=!0},p(s,a){const i={};a&16384&&(i.brush_radius=s[14]),a&8192&&(i.shape=s[13]),a&32&&(i.source=s[5]),a&64&&(i.tool=s[6]),a&32768&&(i.selectable=s[15]),a&128&&(i.label=s[7]),a&256&&(i.show_label=s[8]),a&1024&&(i.pending=s[10]),a&512&&(i.streaming=s[9]),a&4096&&(i.mirror_webcam=s[12]),a&536870912&&(i.$$scope={dirty:a,ctx:s}),!n&&a&1&&(n=!0,i.value=s[0],Q(()=>n=!1)),e.$set(i)},i(s){l||(p(e.$$.fragment,s),l=!0)},o(s){A(e.$$.fragment,s),l=!1},d(s){S(e,s)}}}function Ln(t){let e,n;return e=new Rn({props:{value:t[0],label:t[7],show_label:t[8],selectable:t[15]}}),e.$on("select",t[18]),{c(){B(e.$$.fragment)},m(l,u){z(e,l,u),n=!0},p(l,u){const r={};u&1&&(r.value=l[0]),u&128&&(r.label=l[7]),u&256&&(r.show_label=l[8]),u&32768&&(r.selectable=l[15]),e.$set(r)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function Un(t){let e,n;return e=new Vt({props:{type:"image"}}),{c(){B(e.$$.fragment)},m(l,u){z(e,l,u),n=!0},p:J,i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}function jn(t){let e,n,l,u,r,s;const a=[t[1]];let i={};for(let f=0;f<a.length;f+=1)i=Lt(i,a[f]);e=new Ut({props:i});const _=[Ln,Dn],o=[];function g(f,c){return f[16]==="static"?0:1}return l=g(t),u=o[l]=_[l](t),{c(){B(e.$$.fragment),n=F(),u.c(),r=_e()},m(f,c){z(e,f,c),y(f,n,c),o[l].m(f,c),y(f,r,c),s=!0},p(f,c){const b=c&2?jt(a,[qt(f[1])]):{};e.$set(b);let I=l;l=g(f),l===I?o[l].p(f,c):(x(),A(o[I],1,1,()=>{o[I]=null}),ee(),u=o[l],u?u.p(f,c):(u=o[l]=_[l](f),u.c()),p(u,1),u.m(r.parentNode,r))},i(f){s||(p(e.$$.fragment,f),p(u),s=!0)},o(f){A(e.$$.fragment,f),A(u),s=!1},d(f){S(e,f),f&&C(n),o[l].d(f),f&&C(r)}}}function qn(t){let e,n;return e=new Ft({props:{visible:t[4],variant:t[16]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[17]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height||(t[5]==="webcam"?void 0:bt),width:t[11].width},allow_overflow:!1,$$slots:{default:[jn]},$$scope:{ctx:t}}}),{c(){B(e.$$.fragment)},m(l,u){z(e,l,u),n=!0},p(l,[u]){const r={};u&16&&(r.visible=l[4]),u&65569&&(r.variant=l[16]==="dynamic"&&l[0]===null&&l[5]==="upload"?"dashed":"solid"),u&131072&&(r.border_mode=l[17]?"focus":"base"),u&4&&(r.elem_id=l[2]),u&8&&(r.elem_classes=l[3]),u&2080&&(r.style={height:l[11].height||(l[5]==="webcam"?void 0:bt),width:l[11].width}),u&537130979&&(r.$$scope={dirty:u,ctx:l}),e.$set(r)},i(l){n||(p(e.$$.fragment,l),n=!0)},o(l){A(e.$$.fragment,l),n=!1},d(l){S(e,l)}}}const bt=240;function Fn(t,e,n){let{elem_id:l=""}=e,{elem_classes:u=[]}=e,{visible:r=!0}=e,{value:s=null}=e,{source:a="upload"}=e,{tool:i="editor"}=e,{label:_}=e,{show_label:o}=e,{streaming:g}=e,{pending:f}=e,{style:c={}}=e,{mirror_webcam:b}=e,{shape:I}=e,{brush_radius:q}=e,{selectable:X=!1}=e,{loading_status:U}=e,{mode:ce}=e;const E=ge();let k;function W(w){ae.call(this,t,w)}function Y(w){s=w,n(0,s)}function se(w){ae.call(this,t,w)}function oe(w){ae.call(this,t,w)}function ie(w){ae.call(this,t,w)}function re(w){ae.call(this,t,w)}const O=({detail:w})=>n(17,k=w);function j(w){ae.call(this,t,w)}function Z(w){ae.call(this,t,w)}const te=({detail:w})=>{n(1,U=U||{}),n(1,U.status="error",U),n(1,U.message=w,U)};return t.$$set=w=>{"elem_id"in w&&n(2,l=w.elem_id),"elem_classes"in w&&n(3,u=w.elem_classes),"visible"in w&&n(4,r=w.visible),"value"in w&&n(0,s=w.value),"source"in w&&n(5,a=w.source),"tool"in w&&n(6,i=w.tool),"label"in w&&n(7,_=w.label),"show_label"in w&&n(8,o=w.show_label),"streaming"in w&&n(9,g=w.streaming),"pending"in w&&n(10,f=w.pending),"style"in w&&n(11,c=w.style),"mirror_webcam"in w&&n(12,b=w.mirror_webcam),"shape"in w&&n(13,I=w.shape),"brush_radius"in w&&n(14,q=w.brush_radius),"selectable"in w&&n(15,X=w.selectable),"loading_status"in w&&n(1,U=w.loading_status),"mode"in w&&n(16,ce=w.mode)},t.$$.update=()=>{t.$$.dirty&1&&n(0,s=s||null),t.$$.dirty&1&&E("change")},[s,U,l,u,r,a,i,_,o,g,f,c,b,I,q,X,ce,k,W,Y,se,oe,ie,re,O,j,Z,te]}class Nn extends ne{constructor(e){super(),le(this,e,Fn,qn,$,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,selectable:15,loading_status:1,mode:16})}}const tl=Nn,nl=["static","dynamic"],ll=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{tl as Component,rl as ExampleComponent,ll as document,nl as modes};
//# sourceMappingURL=index-566b59c2.js.map
