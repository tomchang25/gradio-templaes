{"version":3,"file":"Upload.e2b8a533.js","sources":["../../../../ui/packages/upload/src/Upload.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\timport { createEventDispatcher } from \"svelte\";\r\n\timport type { FileData } from \"./types\";\r\n\r\n\texport let filetype: string | null = null;\r\n\texport let include_file_metadata = true;\r\n\texport let dragging = false;\r\n\texport let boundedheight: boolean = true;\r\n\texport let center: boolean = true;\r\n\texport let flex: boolean = true;\r\n\texport let file_count: string = \"single\";\r\n\texport let disable_click = false;\r\n\r\n\tlet hidden_upload: HTMLInputElement;\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tconst updateDragging = () => {\r\n\t\tdragging = !dragging;\r\n\t};\r\n\r\n\tconst openFileUpload = () => {\r\n\t\tif (disable_click) return;\r\n\t\thidden_upload.value = \"\";\r\n\t\thidden_upload.click();\r\n\t};\r\n\r\n\tconst loadFiles = (files: FileList) => {\r\n\t\tlet _files: Array<File> = Array.from(files);\r\n\t\tif (!files.length || !window.FileReader) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (file_count === \"single\") {\r\n\t\t\t_files = [files[0]];\r\n\t\t}\r\n\t\tvar all_file_data: Array<FileData | string> = [];\r\n\t\t_files.forEach((f, i) => {\r\n\t\t\tlet ReaderObj = new FileReader();\r\n\t\t\tReaderObj.readAsDataURL(f);\r\n\t\t\tReaderObj.onloadend = function () {\r\n\t\t\t\tall_file_data[i] = include_file_metadata\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t\tname: f.name,\r\n\t\t\t\t\t\t\tsize: f.size,\r\n\t\t\t\t\t\t\tdata: this.result as string\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t: (this.result as string);\r\n\t\t\t\tif (\r\n\t\t\t\t\tall_file_data.filter((x) => x !== undefined).length === files.length\r\n\t\t\t\t) {\r\n\t\t\t\t\tdispatch(\r\n\t\t\t\t\t\t\"load\",\r\n\t\t\t\t\t\tfile_count == \"single\" ? all_file_data[0] : all_file_data\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t});\r\n\t};\r\n\r\n\tconst loadFilesFromUpload = (e: Event) => {\r\n\t\tconst target = e.target as HTMLInputElement;\r\n\r\n\t\tif (!target.files) return;\r\n\t\tloadFiles(target.files);\r\n\t};\r\n\r\n\tconst loadFilesFromDrop = (e: DragEvent) => {\r\n\t\tdragging = false;\r\n\t\tif (!e.dataTransfer?.files) return;\r\n\t\tloadFiles(e.dataTransfer.files);\r\n\t};\r\n</script>\r\n\r\n<div\r\n\tclass=\"w-full cursor-pointer h-full  items-center justify-center text-gray-400 md:text-xl {boundedheight\r\n\t\t? 'min-h-[10rem] md:min-h-[15rem] max-h-[15rem] xl:max-h-[18rem] 2xl:max-h-[20rem]'\r\n\t\t: ''}\"\r\n\tclass:text-center={center}\r\n\tclass:flex\r\n\ton:drag|preventDefault|stopPropagation\r\n\ton:dragstart|preventDefault|stopPropagation\r\n\ton:dragend|preventDefault|stopPropagation\r\n\ton:dragover|preventDefault|stopPropagation\r\n\ton:dragenter|preventDefault|stopPropagation\r\n\ton:dragleave|preventDefault|stopPropagation\r\n\ton:drop|preventDefault|stopPropagation\r\n\ton:click={openFileUpload}\r\n\ton:drop={loadFilesFromDrop}\r\n\ton:dragenter={updateDragging}\r\n\ton:dragleave={updateDragging}\r\n>\r\n\t<slot />\r\n\t<input\r\n\t\tclass=\"hidden-upload hidden\"\r\n\t\ttype=\"file\"\r\n\t\tbind:this={hidden_upload}\r\n\t\ton:change={loadFilesFromUpload}\r\n\t\taccept={filetype}\r\n\t\tmultiple={file_count === \"multiple\" || undefined}\r\n\t\twebkitdirectory={file_count === \"directory\" || undefined}\r\n\t\tmozdirectory={file_count === \"directory\" || undefined}\r\n\t/>\r\n</div>\r\n"],"names":[],"mappings":"6YAiGU,mBACE,OAAe,YAAc,+BACtB,OAAe,aAAe,MAAS,uBAC1C,OAAe,aAAe,MAAS,qGA1BqC,MACxF,kFACA,uBACgB,+BAJpB,+BAmBC,yCAIY,gNAVF,iBACD,sBACK,sBACA,sHAQL,wBACE,OAAe,YAAc,2CACtB,OAAe,aAAe,qDACjC,OAAe,aAAe,sIA1B8C,MACxF,kFACA,6CACgB,0KAzER,WAA0B,SAC1B,wBAAwB,OACxB,WAAW,OACX,gBAAyB,OACzB,SAAkB,OAClB,OAAgB,OAChB,aAAqB,aACrB,gBAAgB,MAEvB,OAEE,GAAW,KAEX,YACL,GAAY,CAAQ,GAGf,OACD,QACJ,EAAc,MAAQ,MACtB,EAAc,UAGT,EAAa,OACd,GAAsB,MAAM,KAAK,CAAK,QACrC,EAAM,SAAW,OAAO,aAGzB,IAAe,UAClB,IAAU,EAAM,QAEb,MACJ,EAAO,SAAS,EAAG,QACd,MAAgB,YACpB,EAAU,cAAc,CAAC,EACzB,EAAU,qBACT,EAAc,GAAK,GAEhB,KAAM,EAAE,KACR,KAAM,EAAE,KACR,KAAM,KAAK,QAEV,KAAK,OAER,EAAc,OAAQ,GAAM,IAAM,MAAS,EAAE,SAAW,EAAM,QAE9D,EACC,OACA,GAAc,SAAW,EAAc,GAAK,CAAa,OAOxD,EAAuB,SACtB,GAAS,EAAE,QAEZ,EAAO,OACZ,EAAU,EAAO,KAAK,GAGjB,EAAqB,SAC1B,EAAW,EAAK,EACX,EAAE,cAAc,OACrB,EAAU,EAAE,aAAa,KAAK,sQA0BnB"}