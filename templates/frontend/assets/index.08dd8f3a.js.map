{"version":3,"file":"index.08dd8f3a.js","sources":["../../../../ui/packages/file/src/utils.ts","../../../../ui/packages/file/src/File.svelte","../../../../ui/packages/file/src/FileUpload.svelte","../../../../ui/packages/app/src/components/File/File.svelte","../../../../ui/packages/app/src/components/File/index.ts"],"sourcesContent":["import type { FileData } from \"@gradio/upload\";\r\n\r\nexport const prettyBytes = (bytes: number): string => {\r\n\tlet units = [\"B\", \"KB\", \"MB\", \"GB\", \"PB\"];\r\n\tlet i = 0;\r\n\twhile (bytes > 1024) {\r\n\t\tbytes /= 1024;\r\n\t\ti++;\r\n\t}\r\n\tlet unit = units[i];\r\n\treturn bytes.toFixed(1) + \" \" + unit;\r\n};\r\n\r\nexport const display_file_name = (value: FileData): string => {\r\n\tvar str: string;\r\n\tstr = value.orig_name || value.name;\r\n\tif (str.length > 255) {\r\n\t\treturn `${str.substr(0, 255)}...`;\r\n\t} else return str;\r\n};\r\n\r\nexport const download_files = (value: FileData): string => {\r\n\treturn value.data;\r\n};\r\n\r\nexport const display_file_size = (\r\n\tvalue: FileData | Array<FileData>\r\n): string => {\r\n\tvar total_size = 0;\r\n\tif (Array.isArray(value)) {\r\n\t\tfor (var file of value) {\r\n\t\t\tif (file.size !== undefined) total_size += file.size;\r\n\t\t}\r\n\t} else {\r\n\t\ttotal_size = value.size || 0;\r\n\t}\r\n\treturn prettyBytes(total_size);\r\n};\r\n","<script lang=\"ts\">\r\n\timport type { FileData } from \"@gradio/upload\";\r\n\timport { BlockLabel } from \"@gradio/atoms\";\r\n\timport {\r\n\t\tdisplay_file_name,\r\n\t\tdownload_files,\r\n\t\tdisplay_file_size\r\n\t} from \"./utils\";\r\n\timport { File } from \"@gradio/icons\";\r\n\r\n\texport let value: FileData | null;\r\n\texport let label: string;\r\n\texport let show_label: boolean;\r\n</script>\r\n\r\n<BlockLabel {show_label} Icon={File} label={label || \"File\"} />\r\n\r\n{#if value}\r\n\t<div\r\n\t\tclass=\"file-preview overflow-y-scroll w-full max-h-60 flex flex-col justify-between mt-7 mb-7 dark:text-slate-200\"\r\n\t>\r\n\t\t{#if Array.isArray(value)}\r\n\t\t\t{#each value as file}\r\n\t\t\t\t<div class=\"flex flex-row w-full justify-between\">\r\n\t\t\t\t\t<div class=\"file-name p-2\">\r\n\t\t\t\t\t\t{display_file_name(file)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"file-size  p-2\">\r\n\t\t\t\t\t\t{display_file_size(file)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"file-size w-3/12 p-2 hover:underline\">\r\n\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\thref={download_files(file)}\r\n\t\t\t\t\t\t\ttarget={window.__is_colab__ ? \"_blank\" : null}\r\n\t\t\t\t\t\t\tdownload={window.__is_colab__ ? null : display_file_name(file)}\r\n\t\t\t\t\t\t\tclass=\"text-indigo-600 hover:underline dark:text-indigo-300\"\r\n\t\t\t\t\t\t\t>Download</a\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t{:else}\r\n\t\t\t<div class=\"flex flex-row\">\r\n\t\t\t\t<div class=\"file-name w-5/12 p-2\">\r\n\t\t\t\t\t{display_file_name(value)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"file-size w-3/12  p-2\">\r\n\t\t\t\t\t{display_file_size(value)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"file-size w-3/12 p-2 hover:underline\">\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\thref={download_files(value)}\r\n\t\t\t\t\t\ttarget={window.__is_colab__ ? \"_blank\" : null}\r\n\t\t\t\t\t\tdownload={window.__is_colab__ ? null : display_file_name(value)}\r\n\t\t\t\t\t\tclass=\"text-indigo-600 hover:underline dark:text-indigo-300\"\r\n\t\t\t\t\t\t>Download</a\r\n\t\t\t\t\t>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t</div>\r\n{:else}\r\n\t<div class=\"h-full min-h-[15rem] flex justify-center items-center\">\r\n\t\t<div class=\"h-5 dark:text-white opacity-50\"><File /></div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { createEventDispatcher, tick } from \"svelte\";\r\n\timport { Upload, ModifyUpload } from \"@gradio/upload\";\r\n\timport type { FileData } from \"@gradio/upload\";\r\n\timport { BlockLabel } from \"@gradio/atoms\";\r\n\timport { File } from \"@gradio/icons\";\r\n\r\n\timport {\r\n\t\tdisplay_file_name,\r\n\t\tdownload_files,\r\n\t\tdisplay_file_size\r\n\t} from \"./utils\";\r\n\r\n\texport let value: null | FileData | Array<FileData>;\r\n\r\n\texport let drop_text: string = \"Drop a file\";\r\n\texport let or_text: string = \"or\";\r\n\texport let upload_text: string = \"click to upload\";\r\n\texport let label: string = \"\";\r\n\texport let show_label: boolean;\r\n\texport let file_count: string;\r\n\texport let file_types: string[] | null = null;\r\n\r\n\tasync function handle_upload({ detail }: CustomEvent<FileData>) {\r\n\t\tvalue = detail;\r\n\t\tawait tick();\r\n\t\tdispatch(\"change\", value);\r\n\t\tdispatch(\"upload\", detail);\r\n\t}\r\n\r\n\tfunction handle_clear({ detail }: CustomEvent<null>) {\r\n\t\tvalue = null;\r\n\t\tdispatch(\"change\", value);\r\n\t\tdispatch(\"clear\");\r\n\t}\r\n\r\n\tconst dispatch = createEventDispatcher<{\r\n\t\tchange: FileData | null;\r\n\t\tclear: undefined;\r\n\t\tdrag: boolean;\r\n\t\tupload: FileData;\r\n\t\terror: string;\r\n\t}>();\r\n\r\n\tlet accept_file_types: string | null;\r\n\tif (file_types == null) {\r\n\t\taccept_file_types = null;\r\n\t} else {\r\n\t\tfile_types = file_types.map((x) => {\r\n\t\t\tif (x.startsWith(\".\")) {\r\n\t\t\t\treturn x;\r\n\t\t\t} else {\r\n\t\t\t\treturn x + \"/*\";\r\n\t\t\t}\r\n\t\t});\r\n\t\taccept_file_types = file_types.join(\", \");\r\n\t}\r\n\r\n\tlet dragging = false;\r\n\t$: dispatch(\"drag\", dragging);\r\n</script>\r\n\r\n<BlockLabel {show_label} Icon={File} label={label || \"File\"} />\r\n\r\n{#if value === null && file_count === \"single\"}\r\n\t<Upload on:load={handle_upload} filetype={accept_file_types} bind:dragging>\r\n\t\t{drop_text}\r\n\t\t<br />- {or_text} -<br />\r\n\t\t{upload_text}\r\n\t</Upload>\r\n{:else if value === null}\r\n\t<Upload\r\n\t\ton:load={handle_upload}\r\n\t\tfiletype={accept_file_types}\r\n\t\t{file_count}\r\n\t\tbind:dragging\r\n\t>\r\n\t\t{drop_text}\r\n\t\t<br />- {or_text} -<br />\r\n\t\t{upload_text}\r\n\t</Upload>\r\n{:else}\r\n\t<div\r\n\t\tclass=\"file-preview overflow-y-scroll w-full max-h-60 flex flex-col justify-between mt-7 mb-7 dark:text-slate-200\"\r\n\t>\r\n\t\t<ModifyUpload on:clear={handle_clear} absolute />\r\n\t\t{#if Array.isArray(value)}\r\n\t\t\t{#each value as file}\r\n\t\t\t\t<div class=\"flex flex-row w-full justify-between\">\r\n\t\t\t\t\t<div class=\"file-name w-5/12 p-2\">\r\n\t\t\t\t\t\t{display_file_name(file)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"file-size w-3/12 p-2\">\r\n\t\t\t\t\t\t{display_file_size(file)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"file-size w-3/12 p-2 hover:underline\">\r\n\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\thref={download_files(file)}\r\n\t\t\t\t\t\t\tdownload={display_file_name(file)}\r\n\t\t\t\t\t\t\tclass=\"text-indigo-600 hover:underline dark:text-indigo-300\"\r\n\t\t\t\t\t\t\t>Download</a\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/each}\r\n\t\t{:else}\r\n\t\t\t<div class=\"flex flex-row\">\r\n\t\t\t\t<div class=\"file-name p-2\">\r\n\t\t\t\t\t{display_file_name(value)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"file-size  p-2\">\r\n\t\t\t\t\t{display_file_size(value)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"file-size p-2 hover:underline\">\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\thref={download_files(value)}\r\n\t\t\t\t\t\tdownload={display_file_name(value)}\r\n\t\t\t\t\t\tclass=\"text-indigo-600 hover:underline dark:text-indigo-300\"\r\n\t\t\t\t\t\t>Download</a\r\n\t\t\t\t\t>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { File, FileUpload } from \"@gradio/file\";\r\n\timport type { FileData } from \"@gradio/upload\";\r\n\timport { normalise_file } from \"@gradio/upload\";\r\n\timport { Block } from \"@gradio/atoms\";\r\n\r\n\timport StatusTracker from \"../StatusTracker/StatusTracker.svelte\";\r\n\timport type { LoadingStatus } from \"../StatusTracker/types\";\r\n\r\n\timport { _ } from \"svelte-i18n\";\r\n\r\n\texport let elem_id: string = \"\";\r\n\texport let visible: boolean = true;\r\n\texport let value: null | FileData = null;\r\n\texport let mode: \"static\" | \"dynamic\";\r\n\texport let root: string;\r\n\texport let label: string;\r\n\texport let show_label: boolean;\r\n\texport let file_count: string;\r\n\texport let file_types: Array<string> = [\"file\"];\r\n\texport let root_url: null | string;\r\n\r\n\texport let loading_status: LoadingStatus;\r\n\r\n\tlet _value: null | FileData;\r\n\t$: _value = normalise_file(value, root_url ?? root);\r\n\r\n\tlet dragging = false;\r\n</script>\r\n\r\n<Block\r\n\t{visible}\r\n\tvariant={mode === \"dynamic\" && value === null ? \"dashed\" : \"solid\"}\r\n\tcolor={dragging ? \"green\" : \"grey\"}\r\n\tpadding={false}\r\n\t{elem_id}\r\n>\r\n\t<StatusTracker {...loading_status} />\r\n\r\n\t{#if mode === \"dynamic\"}\r\n\t\t<FileUpload\r\n\t\t\t{label}\r\n\t\t\t{show_label}\r\n\t\t\tvalue={_value}\r\n\t\t\t{file_count}\r\n\t\t\t{file_types}\r\n\t\t\ton:change={({ detail }) => (value = detail)}\r\n\t\t\ton:drag={({ detail }) => (dragging = detail)}\r\n\t\t\ton:change\r\n\t\t\ton:clear\r\n\t\t\ton:upload\r\n\t\t\tdrop_text={$_(\"interface.drop_file\")}\r\n\t\t\tor_text={$_(\"or\")}\r\n\t\t\tupload_text={$_(\"interface.click_to_upload\")}\r\n\t\t/>\r\n\t{:else}\r\n\t\t<File value={_value} {label} {show_label} />\r\n\t{/if}\r\n</Block>\r\n","export { default as Component } from \"./File.svelte\";\r\nexport const modes = [\"static\", \"dynamic\"];\r\n\r\nexport const document = (config: Record<string, any>) => ({\r\n\ttype: \"{ name: string; data: string }\",\r\n\tdescription: \"file name and base64 data as an object\",\r\n\texample_data: {\r\n\t\tname: \"zip.zip\",\r\n\t\tdata: \"data:@file/octet-stream;base64,UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA==\"\r\n\t}\r\n});\r\n"],"names":[],"mappings":"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"}